import{g as an,h as Jt,i as sn,k as on,l as un,C as _e,m as ot,p as X,n as ln,o as cn,q as fn,t as dn,v as hn,w as Qt,x as At,y as W,U as gn,H as er,z as pn,D as Ce,E as ve,F as vn,G as tr,J as yn}from"./index-ead8e3d7.js";var rr=function(r){return Object.keys(r).map(function(n){return n.toLowerCase()}).sort().join(";")},bn="X-Amz-Algorithm",nr="X-Amz-Date",mn="X-Amz-Credential",wn="X-Amz-Expires",En="X-Amz-Signature",_n="X-Amz-SignedHeaders",ir="X-Amz-Security-Token",Sn="authorization",ut="host",Tn=nr.toLowerCase(),Cn=ir.toLowerCase(),ar="aws4_request",wt="AWS4-HMAC-SHA256",xn="AWS4",sr="e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855",Nn="UNSIGNED-PAYLOAD",Pn=function(r,n,e){return"".concat(r,"/").concat(n,"/").concat(e,"/").concat(ar)},On=function(r){var n=r.toISOString().replace(/[:\-]|\.\d{3}/g,"");return{longDate:n,shortDate:n.slice(0,8)}},or=function(r){var n=r.credentials,e=r.signingDate,a=e===void 0?new Date:e,i=r.signingRegion,t=r.signingService,o=r.uriEscapePath,u=o===void 0?!0:o,c=n.accessKeyId,s=n.secretAccessKey,l=n.sessionToken,f=On(a),h=f.longDate,d=f.shortDate,g=Pn(d,i,t);return{accessKeyId:c,credentialScope:g,longDate:h,secretAccessKey:s,sessionToken:l,shortDate:d,signingRegion:i,signingService:t,uriEscapePath:u}},ur={};for(var Fe=0;Fe<256;Fe++){var Ge=Fe.toString(16).toLowerCase();Ge.length===1&&(Ge="0"+Ge),ur[Fe]=Ge}function An(r){for(var n="",e=0;e<r.byteLength;e++)n+=ur[r[e]];return n}var Le=function(r,n){var e=new an.Sha256(r);e.update(n);var a=e.digestSync();return a},lt=function(r,n){var e=Le(r,n);return An(e)},kn=globalThis&&globalThis.__read||function(r,n){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var a=e.call(r),i,t=[],o;try{for(;(n===void 0||n-- >0)&&!(i=a.next()).done;)t.push(i.value)}catch(u){o={error:u}}finally{try{i&&!i.done&&(e=a.return)&&e.call(a)}finally{if(o)throw o.error}}return t},Un=function(r){return Object.entries(r).map(function(n){var e,a=kn(n,2),i=a[0],t=a[1];return{key:i.toLowerCase(),value:(e=t?.trim().replace(/\s+/g," "))!==null&&e!==void 0?e:""}}).sort(function(n,e){return n.key<e.key?-1:1}).map(function(n){return"".concat(n.key,":").concat(n.value,`
`)}).join("")},it=globalThis&&globalThis.__read||function(r,n){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var a=e.call(r),i,t=[],o;try{for(;(n===void 0||n-- >0)&&!(i=a.next()).done;)t.push(i.value)}catch(u){o={error:u}}finally{try{i&&!i.done&&(e=a.return)&&e.call(a)}finally{if(o)throw o.error}}return t},Ln=function(r){return Array.from(r).sort(function(n,e){var a=it(n,2),i=a[0],t=a[1],o=it(e,2),u=o[0],c=o[1];return i===u?t<c?-1:1:i<u?-1:1}).map(function(n){var e=it(n,2),a=e[0],i=e[1];return"".concat(kt(a),"=").concat(kt(i))}).join("&")},kt=function(r){return encodeURIComponent(r).replace(/[!'()*]/g,In)},In=function(r){return"%".concat(r.charCodeAt(0).toString(16).toUpperCase())},Rn=function(r,n){return n===void 0&&(n=!0),r?n?encodeURIComponent(r).replace(/%2F/g,"/"):r:"/"},lr=function(r){if(r==null)return sr;if(Mn(r)){var n=lt(null,r);return n}return Nn},Mn=function(r){return typeof r=="string"||ArrayBuffer.isView(r)||Kn(r)},Kn=function(r){return typeof ArrayBuffer=="function"&&r instanceof ArrayBuffer||Object.prototype.toString.call(r)==="[object ArrayBuffer]"},jn=function(r,n){var e=r.body,a=r.headers,i=r.method,t=r.url;return n===void 0&&(n=!0),[i,Rn(t.pathname,n),Ln(t.searchParams),Un(a),rr(a),lr(e)].join(`
`)},Bn=function(r,n,e,a){var i="".concat(xn).concat(r),t=Le(i,n),o=Le(t,e),u=Le(o,a),c=Le(u,ar);return c},zn=function(r,n,e){return[wt,r,n,e].join(`
`)},cr=function(r,n){var e=n.credentialScope,a=n.longDate,i=n.secretAccessKey,t=n.shortDate,o=n.signingRegion,u=n.signingService,c=n.uriEscapePath,s=jn(r,c),l=lt(null,s),f=zn(a,e,l),h=lt(Bn(i,t,o,u),f);return h},Re=globalThis&&globalThis.__assign||function(){return Re=Object.assign||function(r){for(var n,e=1,a=arguments.length;e<a;e++){n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=n[i])}return r},Re.apply(this,arguments)},$n=function(r,n){var e=or(n),a=e.accessKeyId,i=e.credentialScope,t=e.longDate,o=e.sessionToken,u=Re({},r.headers);u[ut]=r.url.host,u[Tn]=t,o&&(u[Cn]=o);var c=Re(Re({},r),{headers:u}),s=cr(c,e),l="Credential=".concat(a,"/").concat(i),f="SignedHeaders=".concat(rr(u)),h="Signature=".concat(s);return u[Sn]="".concat(wt," ").concat(l,", ").concat(f,", ").concat(h),c},He=globalThis&&globalThis.__assign||function(){return He=Object.assign||function(r){for(var n,e=1,a=arguments.length;e<a;e++){n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=n[i])}return r},He.apply(this,arguments)},Fn=globalThis&&globalThis.__rest||function(r,n){var e={};for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&n.indexOf(a)<0&&(e[a]=r[a]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,a=Object.getOwnPropertySymbols(r);i<a.length;i++)n.indexOf(a[i])<0&&Object.prototype.propertyIsEnumerable.call(r,a[i])&&(e[a[i]]=r[a[i]]);return e},Gn=globalThis&&globalThis.__read||function(r,n){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var a=e.call(r),i,t=[],o;try{for(;(n===void 0||n-- >0)&&!(i=a.next()).done;)t.push(i.value)}catch(u){o={error:u}}finally{try{i&&!i.done&&(e=a.return)&&e.call(a)}finally{if(o)throw o.error}}return t},Vn=function(r,n){var e,a,i,t,o=r.body,u=r.method,c=u===void 0?"GET":u,s=r.url,l=n.expiration,f=Fn(n,["expiration"]),h=or(f),d=h.accessKeyId,g=h.credentialScope,p=h.longDate,v=h.sessionToken,m=new URL(s);Object.entries(He(He((e={},e[bn]=wt,e[mn]="".concat(d,"/").concat(g),e[nr]=p,e[_n]=ut,e),l&&(a={},a[wn]=l.toString(),a)),v&&(i={},i[ir]=v,i))).forEach(function(E){var x=Gn(E,2),H=x[0],M=x[1];m.searchParams.append(H,M)});var y={body:o,headers:(t={},t[ut]=s.host,t),method:c,url:m},S=cr(y,h);return m.searchParams.append(En,S),m},fr=function(r){return new Date(Date.now()+r)},Dn=5*60*1e3,Hn=function(r,n){return Math.abs(fr(n).getTime()-r)>=Dn},qn=function(r,n){return Hn(r,n)?r-Date.now():n},Xn=globalThis&&globalThis.__awaiter||function(r,n,e,a){function i(t){return t instanceof e?t:new e(function(o){o(t)})}return new(e||(e=Promise))(function(t,o){function u(l){try{s(a.next(l))}catch(f){o(f)}}function c(l){try{s(a.throw(l))}catch(f){o(f)}}function s(l){l.done?t(l.value):i(l.value).then(u,c)}s((a=a.apply(r,n||[])).next())})},Wn=globalThis&&globalThis.__generator||function(r,n){var e={label:0,sent:function(){if(t[0]&1)throw t[1];return t[1]},trys:[],ops:[]},a,i,t,o;return o={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function u(s){return function(l){return c([s,l])}}function c(s){if(a)throw new TypeError("Generator is already executing.");for(;o&&(o=0,s[0]&&(e=0)),e;)try{if(a=1,i&&(t=s[0]&2?i.return:s[0]?i.throw||((t=i.return)&&t.call(i),0):i.next)&&!(t=t.call(i,s[1])).done)return t;switch(i=0,t&&(s=[s[0]&2,t.value]),s[0]){case 0:case 1:t=s;break;case 4:return e.label++,{value:s[1],done:!1};case 5:e.label++,i=s[1],s=[0];continue;case 7:s=e.ops.pop(),e.trys.pop();continue;default:if(t=e.trys,!(t=t.length>0&&t[t.length-1])&&(s[0]===6||s[0]===2)){e=0;continue}if(s[0]===3&&(!t||s[1]>t[0]&&s[1]<t[3])){e.label=s[1];break}if(s[0]===6&&e.label<t[1]){e.label=t[1],t=s;break}if(t&&e.label<t[2]){e.label=t[2],e.ops.push(s);break}t[2]&&e.ops.pop(),e.trys.pop();continue}s=n.call(r,e)}catch(l){s=[6,l],i=0}finally{a=t=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}},Yn=function(r){var n=r.credentials,e=r.region,a=r.service,i=r.uriEscapePath,t=i===void 0?!0:i,o;return function(u){return function(s){return Xn(this,void 0,void 0,function(){var l,f,h,d,g,p;return Wn(this,function(v){switch(v.label){case 0:return o=o??0,p={},typeof n!="function"?[3,2]:[4,n()];case 1:return f=v.sent(),[3,3];case 2:f=n,v.label=3;case 3:return l=(p.credentials=f,p.signingDate=fr(o),p.signingRegion=e,p.signingService=a,p.uriEscapePath=t,p),[4,$n(s,l)];case 4:return h=v.sent(),[4,u(h)];case 5:return d=v.sent(),g=Zn(d),g&&(o=qn(Date.parse(g),o)),[2,d]}})})}}},Zn=function(r){var n,e,a=r===void 0?{}:r,i=a.headers;return(e=(n=i?.date)!==null&&n!==void 0?n:i?.Date)!==null&&e!==void 0?e:i?.["x-amz-date"]},Jn=Jt(un,[sn,on,Yn]),Qn=function(r){var n=/[!'()*]/g;return encodeURIComponent(r).replace(n,ei)},ei=function(r){return"%".concat(r.charCodeAt(0).toString(16).toUpperCase())},Ve="sendUploadProgress",ct="sendDownloadProgress",ti="canceled",ft="x-amz-content-sha256",ri=globalThis&&globalThis.__awaiter||function(r,n,e,a){function i(t){return t instanceof e?t:new e(function(o){o(t)})}return new(e||(e=Promise))(function(t,o){function u(l){try{s(a.next(l))}catch(f){o(f)}}function c(l){try{s(a.throw(l))}catch(f){o(f)}}function s(l){l.done?t(l.value):i(l.value).then(u,c)}s((a=a.apply(r,n||[])).next())})},ni=globalThis&&globalThis.__generator||function(r,n){var e={label:0,sent:function(){if(t[0]&1)throw t[1];return t[1]},trys:[],ops:[]},a,i,t,o;return o={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function u(s){return function(l){return c([s,l])}}function c(s){if(a)throw new TypeError("Generator is already executing.");for(;o&&(o=0,s[0]&&(e=0)),e;)try{if(a=1,i&&(t=s[0]&2?i.return:s[0]?i.throw||((t=i.return)&&t.call(i),0):i.next)&&!(t=t.call(i,s[1])).done)return t;switch(i=0,t&&(s=[s[0]&2,t.value]),s[0]){case 0:case 1:t=s;break;case 4:return e.label++,{value:s[1],done:!1};case 5:e.label++,i=s[1],s=[0];continue;case 7:s=e.ops.pop(),e.trys.pop();continue;default:if(t=e.trys,!(t=t.length>0&&t[t.length-1])&&(s[0]===6||s[0]===2)){e=0;continue}if(s[0]===3&&(!t||s[1]>t[0]&&s[1]<t[3])){e.label=s[1];break}if(s[0]===6&&e.label<t[1]){e.label=t[1],t=s;break}if(t&&e.label<t[2]){e.label=t[2],e.ops.push(s);break}t[2]&&e.ops.pop(),e.trys.pop();continue}s=n.call(r,e)}catch(l){s=[6,l],i=0}finally{a=t=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}},ii=function(r){return function(n){return function(a){return ri(this,void 0,void 0,function(){var i;return ni(this,function(t){switch(t.label){case 0:return a.headers[ft]?[2,n(a)]:[3,1];case 1:return[4,lr(a.body)];case 2:return i=t.sent(),a.headers[ft]=i,[2,n(a)]}})})}}},Y=Jt(Jn,[ii]),Et={},Ze={};(function(r){const n=":A-Za-z_\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD",e=n+"\\-.\\d\\u00B7\\u0300-\\u036F\\u203F-\\u2040",a="["+n+"]["+e+"]*",i=new RegExp("^"+a+"$"),t=function(u,c){const s=[];let l=c.exec(u);for(;l;){const f=[];f.startIndex=c.lastIndex-l[0].length;const h=l.length;for(let d=0;d<h;d++)f.push(l[d]);s.push(f),l=c.exec(u)}return s},o=function(u){const c=i.exec(u);return!(c===null||typeof c>"u")};r.isExist=function(u){return typeof u<"u"},r.isEmptyObject=function(u){return Object.keys(u).length===0},r.merge=function(u,c,s){if(c){const l=Object.keys(c),f=l.length;for(let h=0;h<f;h++)s==="strict"?u[l[h]]=[c[l[h]]]:u[l[h]]=c[l[h]]}},r.getValue=function(u){return r.isExist(u)?u:""},r.isName=o,r.getAllMatches=t,r.nameRegexp=a})(Ze);const _t=Ze,ai={allowBooleanAttributes:!1,unpairedTags:[]};Et.validate=function(r,n){n=Object.assign({},ai,n);const e=[];let a=!1,i=!1;r[0]==="\uFEFF"&&(r=r.substr(1));for(let t=0;t<r.length;t++)if(r[t]==="<"&&r[t+1]==="?"){if(t+=2,t=Lt(r,t),t.err)return t}else if(r[t]==="<"){let o=t;if(t++,r[t]==="!"){t=It(r,t);continue}else{let u=!1;r[t]==="/"&&(u=!0,t++);let c="";for(;t<r.length&&r[t]!==">"&&r[t]!==" "&&r[t]!=="	"&&r[t]!==`
`&&r[t]!=="\r";t++)c+=r[t];if(c=c.trim(),c[c.length-1]==="/"&&(c=c.substring(0,c.length-1),t--),!hi(c)){let f;return c.trim().length===0?f="Invalid space after '<'.":f="Tag '"+c+"' is an invalid name.",N("InvalidTag",f,j(r,t))}const s=ui(r,t);if(s===!1)return N("InvalidAttr","Attributes for '"+c+"' have open quote.",j(r,t));let l=s.value;if(t=s.index,l[l.length-1]==="/"){const f=t-l.length;l=l.substring(0,l.length-1);const h=Rt(l,n);if(h===!0)a=!0;else return N(h.err.code,h.err.msg,j(r,f+h.err.line))}else if(u)if(s.tagClosed){if(l.trim().length>0)return N("InvalidTag","Closing tag '"+c+"' can't have attributes or invalid starting.",j(r,o));{const f=e.pop();if(c!==f.tagName){let h=j(r,f.tagStartPos);return N("InvalidTag","Expected closing tag '"+f.tagName+"' (opened in line "+h.line+", col "+h.col+") instead of closing tag '"+c+"'.",j(r,o))}e.length==0&&(i=!0)}}else return N("InvalidTag","Closing tag '"+c+"' doesn't have proper closing.",j(r,t));else{const f=Rt(l,n);if(f!==!0)return N(f.err.code,f.err.msg,j(r,t-l.length+f.err.line));if(i===!0)return N("InvalidXml","Multiple possible root nodes found.",j(r,t));n.unpairedTags.indexOf(c)!==-1||e.push({tagName:c,tagStartPos:o}),a=!0}for(t++;t<r.length;t++)if(r[t]==="<")if(r[t+1]==="!"){t++,t=It(r,t);continue}else if(r[t+1]==="?"){if(t=Lt(r,++t),t.err)return t}else break;else if(r[t]==="&"){const f=fi(r,t);if(f==-1)return N("InvalidChar","char '&' is not expected.",j(r,t));t=f}else if(i===!0&&!Ut(r[t]))return N("InvalidXml","Extra text at the end",j(r,t));r[t]==="<"&&t--}}else{if(Ut(r[t]))continue;return N("InvalidChar","char '"+r[t]+"' is not expected.",j(r,t))}if(a){if(e.length==1)return N("InvalidTag","Unclosed tag '"+e[0].tagName+"'.",j(r,e[0].tagStartPos));if(e.length>0)return N("InvalidXml","Invalid '"+JSON.stringify(e.map(t=>t.tagName),null,4).replace(/\r?\n/g,"")+"' found.",{line:1,col:1})}else return N("InvalidXml","Start tag expected.",1);return!0};function Ut(r){return r===" "||r==="	"||r===`
`||r==="\r"}function Lt(r,n){const e=n;for(;n<r.length;n++)if(r[n]=="?"||r[n]==" "){const a=r.substr(e,n-e);if(n>5&&a==="xml")return N("InvalidXml","XML declaration allowed only at the start of the document.",j(r,n));if(r[n]=="?"&&r[n+1]==">"){n++;break}else continue}return n}function It(r,n){if(r.length>n+5&&r[n+1]==="-"&&r[n+2]==="-"){for(n+=3;n<r.length;n++)if(r[n]==="-"&&r[n+1]==="-"&&r[n+2]===">"){n+=2;break}}else if(r.length>n+8&&r[n+1]==="D"&&r[n+2]==="O"&&r[n+3]==="C"&&r[n+4]==="T"&&r[n+5]==="Y"&&r[n+6]==="P"&&r[n+7]==="E"){let e=1;for(n+=8;n<r.length;n++)if(r[n]==="<")e++;else if(r[n]===">"&&(e--,e===0))break}else if(r.length>n+9&&r[n+1]==="["&&r[n+2]==="C"&&r[n+3]==="D"&&r[n+4]==="A"&&r[n+5]==="T"&&r[n+6]==="A"&&r[n+7]==="["){for(n+=8;n<r.length;n++)if(r[n]==="]"&&r[n+1]==="]"&&r[n+2]===">"){n+=2;break}}return n}const si='"',oi="'";function ui(r,n){let e="",a="",i=!1;for(;n<r.length;n++){if(r[n]===si||r[n]===oi)a===""?a=r[n]:a!==r[n]||(a="");else if(r[n]===">"&&a===""){i=!0;break}e+=r[n]}return a!==""?!1:{value:e,index:n,tagClosed:i}}const li=new RegExp(`(\\s*)([^\\s=]+)(\\s*=)?(\\s*(['"])(([\\s\\S])*?)\\5)?`,"g");function Rt(r,n){const e=_t.getAllMatches(r,li),a={};for(let i=0;i<e.length;i++){if(e[i][1].length===0)return N("InvalidAttr","Attribute '"+e[i][2]+"' has no space in starting.",ke(e[i]));if(e[i][3]!==void 0&&e[i][4]===void 0)return N("InvalidAttr","Attribute '"+e[i][2]+"' is without value.",ke(e[i]));if(e[i][3]===void 0&&!n.allowBooleanAttributes)return N("InvalidAttr","boolean attribute '"+e[i][2]+"' is not allowed.",ke(e[i]));const t=e[i][2];if(!di(t))return N("InvalidAttr","Attribute '"+t+"' is an invalid name.",ke(e[i]));if(!a.hasOwnProperty(t))a[t]=1;else return N("InvalidAttr","Attribute '"+t+"' is repeated.",ke(e[i]))}return!0}function ci(r,n){let e=/\d/;for(r[n]==="x"&&(n++,e=/[\da-fA-F]/);n<r.length;n++){if(r[n]===";")return n;if(!r[n].match(e))break}return-1}function fi(r,n){if(n++,r[n]===";")return-1;if(r[n]==="#")return n++,ci(r,n);let e=0;for(;n<r.length;n++,e++)if(!(r[n].match(/\w/)&&e<20)){if(r[n]===";")break;return-1}return n}function N(r,n,e){return{err:{code:r,msg:n,line:e.line||e,col:e.col}}}function di(r){return _t.isName(r)}function hi(r){return _t.isName(r)}function j(r,n){const e=r.substring(0,n).split(/\r?\n/);return{line:e.length,col:e[e.length-1].length+1}}function ke(r){return r.startIndex+r[1].length}var St={};const dr={preserveOrder:!1,attributeNamePrefix:"@_",attributesGroupName:!1,textNodeName:"#text",ignoreAttributes:!0,removeNSPrefix:!1,allowBooleanAttributes:!1,parseTagValue:!0,parseAttributeValue:!1,trimValues:!0,cdataPropName:!1,numberParseOptions:{hex:!0,leadingZeros:!0,eNotation:!0},tagValueProcessor:function(r,n){return n},attributeValueProcessor:function(r,n){return n},stopNodes:[],alwaysCreateTextNode:!1,isArray:()=>!1,commentPropName:!1,unpairedTags:[],processEntities:!0,htmlEntities:!1,ignoreDeclaration:!1,ignorePiTags:!1,transformTagName:!1,transformAttributeName:!1,updateTag:function(r,n,e){return r}},gi=function(r){return Object.assign({},dr,r)};St.buildOptions=gi;St.defaultOptions=dr;class pi{constructor(n){this.tagname=n,this.child=[],this[":@"]={}}add(n,e){n==="__proto__"&&(n="#__proto__"),this.child.push({[n]:e})}addChild(n){n.tagname==="__proto__"&&(n.tagname="#__proto__"),n[":@"]&&Object.keys(n[":@"]).length>0?this.child.push({[n.tagname]:n.child,[":@"]:n[":@"]}):this.child.push({[n.tagname]:n.child})}}var vi=pi;const yi=Ze;function bi(r,n){const e={};if(r[n+3]==="O"&&r[n+4]==="C"&&r[n+5]==="T"&&r[n+6]==="Y"&&r[n+7]==="P"&&r[n+8]==="E"){n=n+9;let a=1,i=!1,t=!1,o="";for(;n<r.length;n++)if(r[n]==="<"&&!t){if(i&&Ei(r,n))n+=7,[entityName,val,n]=mi(r,n+1),val.indexOf("&")===-1&&(e[Ci(entityName)]={regx:RegExp(`&${entityName};`,"g"),val});else if(i&&_i(r,n))n+=8;else if(i&&Si(r,n))n+=8;else if(i&&Ti(r,n))n+=9;else if(wi)t=!0;else throw new Error("Invalid DOCTYPE");a++,o=""}else if(r[n]===">"){if(t?r[n-1]==="-"&&r[n-2]==="-"&&(t=!1,a--):a--,a===0)break}else r[n]==="["?i=!0:o+=r[n];if(a!==0)throw new Error("Unclosed DOCTYPE")}else throw new Error("Invalid Tag instead of DOCTYPE");return{entities:e,i:n}}function mi(r,n){let e="";for(;n<r.length&&r[n]!=="'"&&r[n]!=='"';n++)e+=r[n];if(e=e.trim(),e.indexOf(" ")!==-1)throw new Error("External entites are not supported");const a=r[n++];let i="";for(;n<r.length&&r[n]!==a;n++)i+=r[n];return[e,i,n]}function wi(r,n){return r[n+1]==="!"&&r[n+2]==="-"&&r[n+3]==="-"}function Ei(r,n){return r[n+1]==="!"&&r[n+2]==="E"&&r[n+3]==="N"&&r[n+4]==="T"&&r[n+5]==="I"&&r[n+6]==="T"&&r[n+7]==="Y"}function _i(r,n){return r[n+1]==="!"&&r[n+2]==="E"&&r[n+3]==="L"&&r[n+4]==="E"&&r[n+5]==="M"&&r[n+6]==="E"&&r[n+7]==="N"&&r[n+8]==="T"}function Si(r,n){return r[n+1]==="!"&&r[n+2]==="A"&&r[n+3]==="T"&&r[n+4]==="T"&&r[n+5]==="L"&&r[n+6]==="I"&&r[n+7]==="S"&&r[n+8]==="T"}function Ti(r,n){return r[n+1]==="!"&&r[n+2]==="N"&&r[n+3]==="O"&&r[n+4]==="T"&&r[n+5]==="A"&&r[n+6]==="T"&&r[n+7]==="I"&&r[n+8]==="O"&&r[n+9]==="N"}function Ci(r){if(yi.isName(r))return r;throw new Error(`Invalid entity name ${r}`)}var xi=bi;const Ni=/^[-+]?0x[a-fA-F0-9]+$/,Pi=/^([\-\+])?(0*)(\.[0-9]+([eE]\-?[0-9]+)?|[0-9]+(\.[0-9]+([eE]\-?[0-9]+)?)?)$/;!Number.parseInt&&window.parseInt&&(Number.parseInt=window.parseInt);!Number.parseFloat&&window.parseFloat&&(Number.parseFloat=window.parseFloat);const Oi={hex:!0,leadingZeros:!0,decimalPoint:".",eNotation:!0};function Ai(r,n={}){if(n=Object.assign({},Oi,n),!r||typeof r!="string")return r;let e=r.trim();if(n.skipLike!==void 0&&n.skipLike.test(e))return r;if(n.hex&&Ni.test(e))return Number.parseInt(e,16);{const a=Pi.exec(e);if(a){const i=a[1],t=a[2];let o=ki(a[3]);const u=a[4]||a[6];if(!n.leadingZeros&&t.length>0&&i&&e[2]!==".")return r;if(!n.leadingZeros&&t.length>0&&!i&&e[1]!==".")return r;{const c=Number(e),s=""+c;return s.search(/[eE]/)!==-1||u?n.eNotation?c:r:e.indexOf(".")!==-1?s==="0"&&o===""||s===o||i&&s==="-"+o?c:r:t?o===s||i+o===s?c:r:e===s||e===i+s?c:r}}else return r}}function ki(r){return r&&r.indexOf(".")!==-1&&(r=r.replace(/0+$/,""),r==="."?r="0":r[0]==="."?r="0"+r:r[r.length-1]==="."&&(r=r.substr(0,r.length-1))),r}var Ui=Ai;const Tt=Ze,Ue=vi,Li=xi,Ii=Ui;"<((!\\[CDATA\\[([\\s\\S]*?)(]]>))|((NAME:)?(NAME))([^>]*)>|((\\/)(NAME)\\s*>))([^<]*)".replace(/NAME/g,Tt.nameRegexp);let Ri=class{constructor(n){this.options=n,this.currentNode=null,this.tagsNodeStack=[],this.docTypeEntities={},this.lastEntities={apos:{regex:/&(apos|#39|#x27);/g,val:"'"},gt:{regex:/&(gt|#62|#x3E);/g,val:">"},lt:{regex:/&(lt|#60|#x3C);/g,val:"<"},quot:{regex:/&(quot|#34|#x22);/g,val:'"'}},this.ampEntity={regex:/&(amp|#38|#x26);/g,val:"&"},this.htmlEntities={space:{regex:/&(nbsp|#160);/g,val:" "},cent:{regex:/&(cent|#162);/g,val:"¢"},pound:{regex:/&(pound|#163);/g,val:"£"},yen:{regex:/&(yen|#165);/g,val:"¥"},euro:{regex:/&(euro|#8364);/g,val:"€"},copyright:{regex:/&(copy|#169);/g,val:"©"},reg:{regex:/&(reg|#174);/g,val:"®"},inr:{regex:/&(inr|#8377);/g,val:"₹"}},this.addExternalEntities=Mi,this.parseXml=$i,this.parseTextData=Ki,this.resolveNameSpace=ji,this.buildAttributesMap=zi,this.isItStopNode=Di,this.replaceEntitiesValue=Gi,this.readStopNodeData=qi,this.saveTextToParentTag=Vi,this.addChild=Fi}};function Mi(r){const n=Object.keys(r);for(let e=0;e<n.length;e++){const a=n[e];this.lastEntities[a]={regex:new RegExp("&"+a+";","g"),val:r[a]}}}function Ki(r,n,e,a,i,t,o){if(r!==void 0&&(this.options.trimValues&&!a&&(r=r.trim()),r.length>0)){o||(r=this.replaceEntitiesValue(r));const u=this.options.tagValueProcessor(n,r,e,i,t);return u==null?r:typeof u!=typeof r||u!==r?u:this.options.trimValues?ht(r,this.options.parseTagValue,this.options.numberParseOptions):r.trim()===r?ht(r,this.options.parseTagValue,this.options.numberParseOptions):r}}function ji(r){if(this.options.removeNSPrefix){const n=r.split(":"),e=r.charAt(0)==="/"?"/":"";if(n[0]==="xmlns")return"";n.length===2&&(r=e+n[1])}return r}const Bi=new RegExp(`([^\\s=]+)\\s*(=\\s*(['"])([\\s\\S]*?)\\3)?`,"gm");function zi(r,n,e){if(!this.options.ignoreAttributes&&typeof r=="string"){const a=Tt.getAllMatches(r,Bi),i=a.length,t={};for(let o=0;o<i;o++){const u=this.resolveNameSpace(a[o][1]);let c=a[o][4],s=this.options.attributeNamePrefix+u;if(u.length)if(this.options.transformAttributeName&&(s=this.options.transformAttributeName(s)),s==="__proto__"&&(s="#__proto__"),c!==void 0){this.options.trimValues&&(c=c.trim()),c=this.replaceEntitiesValue(c);const l=this.options.attributeValueProcessor(u,c,n);l==null?t[s]=c:typeof l!=typeof c||l!==c?t[s]=l:t[s]=ht(c,this.options.parseAttributeValue,this.options.numberParseOptions)}else this.options.allowBooleanAttributes&&(t[s]=!0)}if(!Object.keys(t).length)return;if(this.options.attributesGroupName){const o={};return o[this.options.attributesGroupName]=t,o}return t}}const $i=function(r){r=r.replace(/\r\n?/g,`
`);const n=new Ue("!xml");let e=n,a="",i="";for(let t=0;t<r.length;t++)if(r[t]==="<")if(r[t+1]==="/"){const u=be(r,">",t,"Closing Tag is not closed.");let c=r.substring(t+2,u).trim();if(this.options.removeNSPrefix){const f=c.indexOf(":");f!==-1&&(c=c.substr(f+1))}this.options.transformTagName&&(c=this.options.transformTagName(c)),e&&(a=this.saveTextToParentTag(a,e,i));const s=i.substring(i.lastIndexOf(".")+1);if(c&&this.options.unpairedTags.indexOf(c)!==-1)throw new Error(`Unpaired tag can not be used as closing tag: </${c}>`);let l=0;s&&this.options.unpairedTags.indexOf(s)!==-1?(l=i.lastIndexOf(".",i.lastIndexOf(".")-1),this.tagsNodeStack.pop()):l=i.lastIndexOf("."),i=i.substring(0,l),e=this.tagsNodeStack.pop(),a="",t=u}else if(r[t+1]==="?"){let u=dt(r,t,!1,"?>");if(!u)throw new Error("Pi Tag is not closed.");if(a=this.saveTextToParentTag(a,e,i),!(this.options.ignoreDeclaration&&u.tagName==="?xml"||this.options.ignorePiTags)){const c=new Ue(u.tagName);c.add(this.options.textNodeName,""),u.tagName!==u.tagExp&&u.attrExpPresent&&(c[":@"]=this.buildAttributesMap(u.tagExp,i,u.tagName)),this.addChild(e,c,i)}t=u.closeIndex+1}else if(r.substr(t+1,3)==="!--"){const u=be(r,"-->",t+4,"Comment is not closed.");if(this.options.commentPropName){const c=r.substring(t+4,u-2);a=this.saveTextToParentTag(a,e,i),e.add(this.options.commentPropName,[{[this.options.textNodeName]:c}])}t=u}else if(r.substr(t+1,2)==="!D"){const u=Li(r,t);this.docTypeEntities=u.entities,t=u.i}else if(r.substr(t+1,2)==="!["){const u=be(r,"]]>",t,"CDATA is not closed.")-2,c=r.substring(t+9,u);if(a=this.saveTextToParentTag(a,e,i),this.options.cdataPropName)e.add(this.options.cdataPropName,[{[this.options.textNodeName]:c}]);else{let s=this.parseTextData(c,e.tagname,i,!0,!1,!0);s==null&&(s=""),e.add(this.options.textNodeName,s)}t=u+2}else{let u=dt(r,t,this.options.removeNSPrefix),c=u.tagName;const s=u.rawTagName;let l=u.tagExp,f=u.attrExpPresent,h=u.closeIndex;this.options.transformTagName&&(c=this.options.transformTagName(c)),e&&a&&e.tagname!=="!xml"&&(a=this.saveTextToParentTag(a,e,i,!1));const d=e;if(d&&this.options.unpairedTags.indexOf(d.tagname)!==-1&&(e=this.tagsNodeStack.pop(),i=i.substring(0,i.lastIndexOf("."))),c!==n.tagname&&(i+=i?"."+c:c),this.isItStopNode(this.options.stopNodes,i,c)){let g="";if(l.length>0&&l.lastIndexOf("/")===l.length-1)t=u.closeIndex;else if(this.options.unpairedTags.indexOf(c)!==-1)t=u.closeIndex;else{const v=this.readStopNodeData(r,s,h+1);if(!v)throw new Error(`Unexpected end of ${s}`);t=v.i,g=v.tagContent}const p=new Ue(c);c!==l&&f&&(p[":@"]=this.buildAttributesMap(l,i,c)),g&&(g=this.parseTextData(g,c,i,!0,f,!0,!0)),i=i.substr(0,i.lastIndexOf(".")),p.add(this.options.textNodeName,g),this.addChild(e,p,i)}else{if(l.length>0&&l.lastIndexOf("/")===l.length-1){c[c.length-1]==="/"?(c=c.substr(0,c.length-1),i=i.substr(0,i.length-1),l=c):l=l.substr(0,l.length-1),this.options.transformTagName&&(c=this.options.transformTagName(c));const g=new Ue(c);c!==l&&f&&(g[":@"]=this.buildAttributesMap(l,i,c)),this.addChild(e,g,i),i=i.substr(0,i.lastIndexOf("."))}else{const g=new Ue(c);this.tagsNodeStack.push(e),c!==l&&f&&(g[":@"]=this.buildAttributesMap(l,i,c)),this.addChild(e,g,i),e=g}a="",t=h}}else a+=r[t];return n.child};function Fi(r,n,e){const a=this.options.updateTag(n.tagname,e,n[":@"]);a===!1||(typeof a=="string"&&(n.tagname=a),r.addChild(n))}const Gi=function(r){if(this.options.processEntities){for(let n in this.docTypeEntities){const e=this.docTypeEntities[n];r=r.replace(e.regx,e.val)}for(let n in this.lastEntities){const e=this.lastEntities[n];r=r.replace(e.regex,e.val)}if(this.options.htmlEntities)for(let n in this.htmlEntities){const e=this.htmlEntities[n];r=r.replace(e.regex,e.val)}r=r.replace(this.ampEntity.regex,this.ampEntity.val)}return r};function Vi(r,n,e,a){return r&&(a===void 0&&(a=Object.keys(n.child).length===0),r=this.parseTextData(r,n.tagname,e,!1,n[":@"]?Object.keys(n[":@"]).length!==0:!1,a),r!==void 0&&r!==""&&n.add(this.options.textNodeName,r),r=""),r}function Di(r,n,e){const a="*."+e;for(const i in r){const t=r[i];if(a===t||n===t)return!0}return!1}function Hi(r,n,e=">"){let a,i="";for(let t=n;t<r.length;t++){let o=r[t];if(a)o===a&&(a="");else if(o==='"'||o==="'")a=o;else if(o===e[0])if(e[1]){if(r[t+1]===e[1])return{data:i,index:t}}else return{data:i,index:t};else o==="	"&&(o=" ");i+=o}}function be(r,n,e,a){const i=r.indexOf(n,e);if(i===-1)throw new Error(a);return i+n.length-1}function dt(r,n,e,a=">"){const i=Hi(r,n+1,a);if(!i)return;let t=i.data;const o=i.index,u=t.search(/\s/);let c=t,s=!0;u!==-1&&(c=t.substr(0,u).replace(/\s\s*$/,""),t=t.substr(u+1));const l=c;if(e){const f=c.indexOf(":");f!==-1&&(c=c.substr(f+1),s=c!==i.data.substr(f+1))}return{tagName:c,tagExp:t,closeIndex:o,attrExpPresent:s,rawTagName:l}}function qi(r,n,e){const a=e;let i=1;for(;e<r.length;e++)if(r[e]==="<")if(r[e+1]==="/"){const t=be(r,">",e,`${n} is not closed`);if(r.substring(e+2,t).trim()===n&&(i--,i===0))return{tagContent:r.substring(a,e),i:t};e=t}else if(r[e+1]==="?")e=be(r,"?>",e+1,"StopNode is not closed.");else if(r.substr(e+1,3)==="!--")e=be(r,"-->",e+3,"StopNode is not closed.");else if(r.substr(e+1,2)==="![")e=be(r,"]]>",e,"StopNode is not closed.")-2;else{const t=dt(r,e,">");t&&((t&&t.tagName)===n&&t.tagExp[t.tagExp.length-1]!=="/"&&i++,e=t.closeIndex)}}function ht(r,n,e){if(n&&typeof r=="string"){const a=r.trim();return a==="true"?!0:a==="false"?!1:Ii(r,e)}else return Tt.isExist(r)?r:""}var Xi=Ri,hr={};function Wi(r,n){return gr(r,n)}function gr(r,n,e){let a;const i={};for(let t=0;t<r.length;t++){const o=r[t],u=Yi(o);let c="";if(e===void 0?c=u:c=e+"."+u,u===n.textNodeName)a===void 0?a=o[u]:a+=""+o[u];else{if(u===void 0)continue;if(o[u]){let s=gr(o[u],n,c);const l=Ji(s,n);o[":@"]?Zi(s,o[":@"],c,n):Object.keys(s).length===1&&s[n.textNodeName]!==void 0&&!n.alwaysCreateTextNode?s=s[n.textNodeName]:Object.keys(s).length===0&&(n.alwaysCreateTextNode?s[n.textNodeName]="":s=""),i[u]!==void 0&&i.hasOwnProperty(u)?(Array.isArray(i[u])||(i[u]=[i[u]]),i[u].push(s)):n.isArray(u,c,l)?i[u]=[s]:i[u]=s}}}return typeof a=="string"?a.length>0&&(i[n.textNodeName]=a):a!==void 0&&(i[n.textNodeName]=a),i}function Yi(r){const n=Object.keys(r);for(let e=0;e<n.length;e++){const a=n[e];if(a!==":@")return a}}function Zi(r,n,e,a){if(n){const i=Object.keys(n),t=i.length;for(let o=0;o<t;o++){const u=i[o];a.isArray(u,e+"."+u,!0,!0)?r[u]=[n[u]]:r[u]=n[u]}}}function Ji(r,n){const{textNodeName:e}=n,a=Object.keys(r).length;return!!(a===0||a===1&&(r[e]||typeof r[e]=="boolean"||r[e]===0))}hr.prettify=Wi;const{buildOptions:Qi}=St,ea=Xi,{prettify:ta}=hr,ra=Et;let na=class{constructor(n){this.externalEntities={},this.options=Qi(n)}parse(n,e){if(typeof n!="string")if(n.toString)n=n.toString();else throw new Error("XML data is accepted in String or Bytes[] form.");if(e){e===!0&&(e={});const t=ra.validate(n,e);if(t!==!0)throw Error(`${t.err.msg}:${t.err.line}:${t.err.col}`)}const a=new ea(this.options);a.addExternalEntities(this.externalEntities);const i=a.parseXml(n);return this.options.preserveOrder||i===void 0?i:ta(i,this.options)}addEntity(n,e){if(e.indexOf("&")!==-1)throw new Error("Entity value can't have '&'");if(n.indexOf("&")!==-1||n.indexOf(";")!==-1)throw new Error("An entity must be set without '&' and ';'. Eg. use '#xD' for '&#xD;'");if(e==="&")throw new Error("An entity with value '&' is not permitted");this.externalEntities[n]=e}};var ia=na;const aa=`
`;function sa(r,n){let e="";return n.format&&n.indentBy.length>0&&(e=aa),pr(r,n,"",e)}function pr(r,n,e,a){let i="",t=!1;for(let o=0;o<r.length;o++){const u=r[o],c=oa(u);if(c===void 0)continue;let s="";if(e.length===0?s=c:s=`${e}.${c}`,c===n.textNodeName){let g=u[c];ua(s,n)||(g=n.tagValueProcessor(c,g),g=vr(g,n)),t&&(i+=a),i+=g,t=!1;continue}else if(c===n.cdataPropName){t&&(i+=a),i+=`<![CDATA[${u[c][0][n.textNodeName]}]]>`,t=!1;continue}else if(c===n.commentPropName){i+=a+`<!--${u[c][0][n.textNodeName]}-->`,t=!0;continue}else if(c[0]==="?"){const g=Mt(u[":@"],n),p=c==="?xml"?"":a;let v=u[c][0][n.textNodeName];v=v.length!==0?" "+v:"",i+=p+`<${c}${v}${g}?>`,t=!0;continue}let l=a;l!==""&&(l+=n.indentBy);const f=Mt(u[":@"],n),h=a+`<${c}${f}`,d=pr(u[c],n,s,l);n.unpairedTags.indexOf(c)!==-1?n.suppressUnpairedNode?i+=h+">":i+=h+"/>":(!d||d.length===0)&&n.suppressEmptyNode?i+=h+"/>":d&&d.endsWith(">")?i+=h+`>${d}${a}</${c}>`:(i+=h+">",d&&a!==""&&(d.includes("/>")||d.includes("</"))?i+=a+n.indentBy+d+a:i+=d,i+=`</${c}>`),t=!0}return i}function oa(r){const n=Object.keys(r);for(let e=0;e<n.length;e++){const a=n[e];if(r.hasOwnProperty(a)&&a!==":@")return a}}function Mt(r,n){let e="";if(r&&!n.ignoreAttributes)for(let a in r){if(!r.hasOwnProperty(a))continue;let i=n.attributeValueProcessor(a,r[a]);i=vr(i,n),i===!0&&n.suppressBooleanAttributes?e+=` ${a.substr(n.attributeNamePrefix.length)}`:e+=` ${a.substr(n.attributeNamePrefix.length)}="${i}"`}return e}function ua(r,n){r=r.substr(0,r.length-n.textNodeName.length-1);let e=r.substr(r.lastIndexOf(".")+1);for(let a in n.stopNodes)if(n.stopNodes[a]===r||n.stopNodes[a]==="*."+e)return!0;return!1}function vr(r,n){if(r&&r.length>0&&n.processEntities)for(let e=0;e<n.entities.length;e++){const a=n.entities[e];r=r.replace(a.regex,a.val)}return r}var la=sa;const ca=la,fa={attributeNamePrefix:"@_",attributesGroupName:!1,textNodeName:"#text",ignoreAttributes:!0,cdataPropName:!1,format:!1,indentBy:"  ",suppressEmptyNode:!1,suppressUnpairedNode:!0,suppressBooleanAttributes:!0,tagValueProcessor:function(r,n){return n},attributeValueProcessor:function(r,n){return n},preserveOrder:!1,commentPropName:!1,unpairedTags:[],entities:[{regex:new RegExp("&","g"),val:"&amp;"},{regex:new RegExp(">","g"),val:"&gt;"},{regex:new RegExp("<","g"),val:"&lt;"},{regex:new RegExp("'","g"),val:"&apos;"},{regex:new RegExp('"',"g"),val:"&quot;"}],processEntities:!0,stopNodes:[],oneListGroup:!1};function fe(r){this.options=Object.assign({},fa,r),this.options.ignoreAttributes||this.options.attributesGroupName?this.isAttribute=function(){return!1}:(this.attrPrefixLen=this.options.attributeNamePrefix.length,this.isAttribute=ga),this.processTextOrObjNode=da,this.options.format?(this.indentate=ha,this.tagEndChar=`>
`,this.newLine=`
`):(this.indentate=function(){return""},this.tagEndChar=">",this.newLine="")}fe.prototype.build=function(r){return this.options.preserveOrder?ca(r,this.options):(Array.isArray(r)&&this.options.arrayNodeName&&this.options.arrayNodeName.length>1&&(r={[this.options.arrayNodeName]:r}),this.j2x(r,0).val)};fe.prototype.j2x=function(r,n){let e="",a="";for(let i in r)if(Object.prototype.hasOwnProperty.call(r,i))if(typeof r[i]>"u")this.isAttribute(i)&&(a+="");else if(r[i]===null)this.isAttribute(i)?a+="":i[0]==="?"?a+=this.indentate(n)+"<"+i+"?"+this.tagEndChar:a+=this.indentate(n)+"<"+i+"/"+this.tagEndChar;else if(r[i]instanceof Date)a+=this.buildTextValNode(r[i],i,"",n);else if(typeof r[i]!="object"){const t=this.isAttribute(i);if(t)e+=this.buildAttrPairStr(t,""+r[i]);else if(i===this.options.textNodeName){let o=this.options.tagValueProcessor(i,""+r[i]);a+=this.replaceEntitiesValue(o)}else a+=this.buildTextValNode(r[i],i,"",n)}else if(Array.isArray(r[i])){const t=r[i].length;let o="";for(let u=0;u<t;u++){const c=r[i][u];typeof c>"u"||(c===null?i[0]==="?"?a+=this.indentate(n)+"<"+i+"?"+this.tagEndChar:a+=this.indentate(n)+"<"+i+"/"+this.tagEndChar:typeof c=="object"?this.options.oneListGroup?o+=this.j2x(c,n+1).val:o+=this.processTextOrObjNode(c,i,n):o+=this.buildTextValNode(c,i,"",n))}this.options.oneListGroup&&(o=this.buildObjectNode(o,i,"",n)),a+=o}else if(this.options.attributesGroupName&&i===this.options.attributesGroupName){const t=Object.keys(r[i]),o=t.length;for(let u=0;u<o;u++)e+=this.buildAttrPairStr(t[u],""+r[i][t[u]])}else a+=this.processTextOrObjNode(r[i],i,n);return{attrStr:e,val:a}};fe.prototype.buildAttrPairStr=function(r,n){return n=this.options.attributeValueProcessor(r,""+n),n=this.replaceEntitiesValue(n),this.options.suppressBooleanAttributes&&n==="true"?" "+r:" "+r+'="'+n+'"'};function da(r,n,e){const a=this.j2x(r,e+1);return r[this.options.textNodeName]!==void 0&&Object.keys(r).length===1?this.buildTextValNode(r[this.options.textNodeName],n,a.attrStr,e):this.buildObjectNode(a.val,n,a.attrStr,e)}fe.prototype.buildObjectNode=function(r,n,e,a){if(r==="")return n[0]==="?"?this.indentate(a)+"<"+n+e+"?"+this.tagEndChar:this.indentate(a)+"<"+n+e+this.closeTag(n)+this.tagEndChar;{let i="</"+n+this.tagEndChar,t="";return n[0]==="?"&&(t="?",i=""),(e||e==="")&&r.indexOf("<")===-1?this.indentate(a)+"<"+n+e+t+">"+r+i:this.options.commentPropName!==!1&&n===this.options.commentPropName&&t.length===0?this.indentate(a)+`<!--${r}-->`+this.newLine:this.indentate(a)+"<"+n+e+t+this.tagEndChar+r+this.indentate(a)+i}};fe.prototype.closeTag=function(r){let n="";return this.options.unpairedTags.indexOf(r)!==-1?this.options.suppressUnpairedNode||(n="/"):this.options.suppressEmptyNode?n="/":n=`></${r}`,n};fe.prototype.buildTextValNode=function(r,n,e,a){if(this.options.cdataPropName!==!1&&n===this.options.cdataPropName)return this.indentate(a)+`<![CDATA[${r}]]>`+this.newLine;if(this.options.commentPropName!==!1&&n===this.options.commentPropName)return this.indentate(a)+`<!--${r}-->`+this.newLine;if(n[0]==="?")return this.indentate(a)+"<"+n+e+"?"+this.tagEndChar;{let i=this.options.tagValueProcessor(n,r);return i=this.replaceEntitiesValue(i),i===""?this.indentate(a)+"<"+n+e+this.closeTag(n)+this.tagEndChar:this.indentate(a)+"<"+n+e+">"+i+"</"+n+this.tagEndChar}};fe.prototype.replaceEntitiesValue=function(r){if(r&&r.length>0&&this.options.processEntities)for(let n=0;n<this.options.entities.length;n++){const e=this.options.entities[n];r=r.replace(e.regex,e.val)}return r};function ha(r){return this.options.indentBy.repeat(r)}function ga(r){return r.startsWith(this.options.attributeNamePrefix)&&r!==this.options.textNodeName?r.substr(this.attrPrefixLen):!1}var pa=fe;const va=Et,ya=ia,ba=pa;var ma={XMLParser:ya,XMLValidator:va,XMLBuilder:ba},wa={parse:function(r){var n=new ma.XMLParser({attributeNamePrefix:"",htmlEntities:!0,ignoreAttributes:!1,ignoreDeclaration:!0,parseTagValue:!1,trimValues:!1,removeNSPrefix:!0,tagValueProcessor:function(o,u){return u.trim()===""&&u.includes(`
`)?"":void 0}});n.addEntity("#xD","\r"),n.addEntity("#10",`
`);var e=n.parse(r),a="#text",i=Object.keys(e)[0],t=e[i];return t[a]&&(t[i]=t[a],delete t[a]),yr(t)}},yr=function(r){var n="#text";for(var e in r)r.hasOwnProperty(e)&&r[e][n]!==void 0?r[e]=r[e][n]:typeof r[e]=="object"&&r[e]!==null&&(r[e]=yr(r[e]));return r};globalThis&&globalThis.__read;new _e("xhr-http-handler");var gt=function(r){return!!r?.__CANCEL__};function Ea(r){return ot.Buffer.from(r,"utf-8")}function pt(r){return typeof r=="string"?ot.Buffer.from(r,"utf-8").toString("base64"):new ot.Buffer(r.buffer).toString("base64")}var br=globalThis&&globalThis.__awaiter||function(r,n,e,a){function i(t){return t instanceof e?t:new e(function(o){o(t)})}return new(e||(e=Promise))(function(t,o){function u(l){try{s(a.next(l))}catch(f){o(f)}}function c(l){try{s(a.throw(l))}catch(f){o(f)}}function s(l){l.done?t(l.value):i(l.value).then(u,c)}s((a=a.apply(r,n||[])).next())})},mr=globalThis&&globalThis.__generator||function(r,n){var e={label:0,sent:function(){if(t[0]&1)throw t[1];return t[1]},trys:[],ops:[]},a,i,t,o;return o={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function u(s){return function(l){return c([s,l])}}function c(s){if(a)throw new TypeError("Generator is already executing.");for(;o&&(o=0,s[0]&&(e=0)),e;)try{if(a=1,i&&(t=s[0]&2?i.return:s[0]?i.throw||((t=i.return)&&t.call(i),0):i.next)&&!(t=t.call(i,s[1])).done)return t;switch(i=0,t&&(s=[s[0]&2,t.value]),s[0]){case 0:case 1:t=s;break;case 4:return e.label++,{value:s[1],done:!1};case 5:e.label++,i=s[1],s=[0];continue;case 7:s=e.ops.pop(),e.trys.pop();continue;default:if(t=e.trys,!(t=t.length>0&&t[t.length-1])&&(s[0]===6||s[0]===2)){e=0;continue}if(s[0]===3&&(!t||s[1]>t[0]&&s[1]<t[3])){e.label=s[1];break}if(s[0]===6&&e.label<t[1]){e.label=t[1],t=s;break}if(t&&e.label<t[2]){e.label=t[2],e.ops.push(s);break}t[2]&&e.ops.pop(),e.trys.pop();continue}s=n.call(r,e)}catch(l){s=[6,l],i=0}finally{a=t=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}},D=function(r){return br(void 0,void 0,void 0,function(){var n,e,a,i,t,o,u;return mr(this,function(c){switch(c.label){case 0:return!r||r.statusCode<300?[2]:(n=r.statusCode,[4,Se(r)]);case 1:return e=c.sent(),a=e?.Code?e.Code:n===404?"NotFound":n.toString(),i=(u=(o=e?.message)!==null&&o!==void 0?o:e?.Message)!==null&&u!==void 0?u:a,t=new Error(i),[2,Object.assign(t,{name:a,$metadata:X(r)})]}})})},Se=function(r){return br(void 0,void 0,void 0,function(){var n;return mr(this,function(e){switch(e.label){case 0:if(!r.body)throw new Error("S3 aborted request.");return[4,r.body.text()];case 1:if(n=e.sent(),n?.length>0)try{return[2,wa.parse(n)]}catch{throw new Error("Failed to parse XML response.")}return[2,{}]}})})},_a=globalThis&&globalThis.__values||function(r){var n=typeof Symbol=="function"&&Symbol.iterator,e=n&&r[n],a=0;if(e)return e.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&a>=r.length&&(r=void 0),{value:r&&r[a++],done:!r}}};throw new TypeError(n?"Object is not iterable.":"Symbol.iterator is not defined.")},Kt=globalThis&&globalThis.__read||function(r,n){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var a=e.call(r),i,t=[],o;try{for(;(n===void 0||n-- >0)&&!(i=a.next()).done;)t.push(i.value)}catch(u){o={error:u}}finally{try{i&&!i.done&&(e=a.return)&&e.call(a)}finally{if(o)throw o.error}}return t},$=function(r,n){var e,a,i={};try{for(var t=_a(Object.entries(n)),o=t.next();!o.done;o=t.next()){var u=Kt(o.value,2),c=u[0],s=u[1],l=Kt(Array.isArray(s)?s:[s],2),f=l[0],h=l[1];r.hasOwnProperty(f)&&(i[c]=h?h(r[f]):String(r[f]))}}catch(d){e={error:d}}finally{try{o&&!o.done&&(a=t.return)&&a.call(t)}finally{if(e)throw e.error}}return i},Q=function(r){return r?Number(r):void 0},qe=function(r){return r?r==="true":void 0},Me=function(r){return r?new Date(r):void 0},Xe=function(r,n){if(r==="")return[];var e=(Array.isArray(r)?r:[r]).filter(function(a){return a!=null});return n(e)},wr=function(r){var n="x-amz-meta-",e=Object.keys(r).filter(function(a){return a.startsWith(n)}).reduce(function(a,i){return a[i.replace(n,"")]=r[i],a},{});return Object.keys(e).length>0?e:void 0},oe=64,Sa=16,Ta=[1732584193,4023233417,2562383102,271733878],Er=function(){function r(){this.state=Uint32Array.from(Ta),this.buffer=new DataView(new ArrayBuffer(oe)),this.bufferLength=0,this.bytesHashed=0,this.finished=!1}return r.prototype.update=function(n){if(!Ca(n)){if(this.finished)throw new Error("Attempted to update an already finished hash.");var e=xa(n),a=0,i=e.byteLength;for(this.bytesHashed+=i;i>0;)this.buffer.setUint8(this.bufferLength++,e[a++]),i--,this.bufferLength===oe&&(this.hashBuffer(),this.bufferLength=0)}},r.prototype.digest=function(){return ln(this,void 0,void 0,function(){var n,e,a,i,t,u,u,o,u;return cn(this,function(c){if(!this.finished){if(n=this,e=n.buffer,a=n.bufferLength,i=n.bytesHashed,t=i*8,e.setUint8(this.bufferLength++,128),a%oe>=oe-8){for(u=this.bufferLength;u<oe;u++)e.setUint8(u,0);this.hashBuffer(),this.bufferLength=0}for(u=this.bufferLength;u<oe-8;u++)e.setUint8(u,0);e.setUint32(oe-8,t>>>0,!0),e.setUint32(oe-4,Math.floor(t/4294967296),!0),this.hashBuffer(),this.finished=!0}for(o=new DataView(new ArrayBuffer(Sa)),u=0;u<4;u++)o.setUint32(u*4,this.state[u],!0);return[2,new Uint8Array(o.buffer,o.byteOffset,o.byteLength)]})})},r.prototype.hashBuffer=function(){var n=this,e=n.buffer,a=n.state,i=a[0],t=a[1],o=a[2],u=a[3];i=A(i,t,o,u,e.getUint32(0,!0),7,3614090360),u=A(u,i,t,o,e.getUint32(4,!0),12,3905402710),o=A(o,u,i,t,e.getUint32(8,!0),17,606105819),t=A(t,o,u,i,e.getUint32(12,!0),22,3250441966),i=A(i,t,o,u,e.getUint32(16,!0),7,4118548399),u=A(u,i,t,o,e.getUint32(20,!0),12,1200080426),o=A(o,u,i,t,e.getUint32(24,!0),17,2821735955),t=A(t,o,u,i,e.getUint32(28,!0),22,4249261313),i=A(i,t,o,u,e.getUint32(32,!0),7,1770035416),u=A(u,i,t,o,e.getUint32(36,!0),12,2336552879),o=A(o,u,i,t,e.getUint32(40,!0),17,4294925233),t=A(t,o,u,i,e.getUint32(44,!0),22,2304563134),i=A(i,t,o,u,e.getUint32(48,!0),7,1804603682),u=A(u,i,t,o,e.getUint32(52,!0),12,4254626195),o=A(o,u,i,t,e.getUint32(56,!0),17,2792965006),t=A(t,o,u,i,e.getUint32(60,!0),22,1236535329),i=k(i,t,o,u,e.getUint32(4,!0),5,4129170786),u=k(u,i,t,o,e.getUint32(24,!0),9,3225465664),o=k(o,u,i,t,e.getUint32(44,!0),14,643717713),t=k(t,o,u,i,e.getUint32(0,!0),20,3921069994),i=k(i,t,o,u,e.getUint32(20,!0),5,3593408605),u=k(u,i,t,o,e.getUint32(40,!0),9,38016083),o=k(o,u,i,t,e.getUint32(60,!0),14,3634488961),t=k(t,o,u,i,e.getUint32(16,!0),20,3889429448),i=k(i,t,o,u,e.getUint32(36,!0),5,568446438),u=k(u,i,t,o,e.getUint32(56,!0),9,3275163606),o=k(o,u,i,t,e.getUint32(12,!0),14,4107603335),t=k(t,o,u,i,e.getUint32(32,!0),20,1163531501),i=k(i,t,o,u,e.getUint32(52,!0),5,2850285829),u=k(u,i,t,o,e.getUint32(8,!0),9,4243563512),o=k(o,u,i,t,e.getUint32(28,!0),14,1735328473),t=k(t,o,u,i,e.getUint32(48,!0),20,2368359562),i=U(i,t,o,u,e.getUint32(20,!0),4,4294588738),u=U(u,i,t,o,e.getUint32(32,!0),11,2272392833),o=U(o,u,i,t,e.getUint32(44,!0),16,1839030562),t=U(t,o,u,i,e.getUint32(56,!0),23,4259657740),i=U(i,t,o,u,e.getUint32(4,!0),4,2763975236),u=U(u,i,t,o,e.getUint32(16,!0),11,1272893353),o=U(o,u,i,t,e.getUint32(28,!0),16,4139469664),t=U(t,o,u,i,e.getUint32(40,!0),23,3200236656),i=U(i,t,o,u,e.getUint32(52,!0),4,681279174),u=U(u,i,t,o,e.getUint32(0,!0),11,3936430074),o=U(o,u,i,t,e.getUint32(12,!0),16,3572445317),t=U(t,o,u,i,e.getUint32(24,!0),23,76029189),i=U(i,t,o,u,e.getUint32(36,!0),4,3654602809),u=U(u,i,t,o,e.getUint32(48,!0),11,3873151461),o=U(o,u,i,t,e.getUint32(60,!0),16,530742520),t=U(t,o,u,i,e.getUint32(8,!0),23,3299628645),i=L(i,t,o,u,e.getUint32(0,!0),6,4096336452),u=L(u,i,t,o,e.getUint32(28,!0),10,1126891415),o=L(o,u,i,t,e.getUint32(56,!0),15,2878612391),t=L(t,o,u,i,e.getUint32(20,!0),21,4237533241),i=L(i,t,o,u,e.getUint32(48,!0),6,1700485571),u=L(u,i,t,o,e.getUint32(12,!0),10,2399980690),o=L(o,u,i,t,e.getUint32(40,!0),15,4293915773),t=L(t,o,u,i,e.getUint32(4,!0),21,2240044497),i=L(i,t,o,u,e.getUint32(32,!0),6,1873313359),u=L(u,i,t,o,e.getUint32(60,!0),10,4264355552),o=L(o,u,i,t,e.getUint32(24,!0),15,2734768916),t=L(t,o,u,i,e.getUint32(52,!0),21,1309151649),i=L(i,t,o,u,e.getUint32(16,!0),6,4149444226),u=L(u,i,t,o,e.getUint32(44,!0),10,3174756917),o=L(o,u,i,t,e.getUint32(8,!0),15,718787259),t=L(t,o,u,i,e.getUint32(36,!0),21,3951481745),a[0]=i+a[0]&4294967295,a[1]=t+a[1]&4294967295,a[2]=o+a[2]&4294967295,a[3]=u+a[3]&4294967295},r}();function Je(r,n,e,a,i,t){return n=(n+r&4294967295)+(a+t&4294967295)&4294967295,(n<<i|n>>>32-i)+e&4294967295}function A(r,n,e,a,i,t,o){return Je(n&e|~n&a,r,n,i,t,o)}function k(r,n,e,a,i,t,o){return Je(n&a|e&~a,r,n,i,t,o)}function U(r,n,e,a,i,t,o){return Je(n^e^a,r,n,i,t,o)}function L(r,n,e,a,i,t,o){return Je(e^(n|~a),r,n,i,t,o)}function Ca(r){return typeof r=="string"?r.length===0:r.byteLength===0}function xa(r){return typeof r=="string"?fn(r):ArrayBuffer.isView(r)?new Uint8Array(r.buffer,r.byteOffset,r.byteLength/Uint8Array.BYTES_PER_ELEMENT):new Uint8Array(r)}var Ke=globalThis&&globalThis.__assign||function(){return Ke=Object.assign||function(r){for(var n,e=1,a=arguments.length;e<a;e++){n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=n[i])}return r},Ke.apply(this,arguments)},vt=globalThis&&globalThis.__awaiter||function(r,n,e,a){function i(t){return t instanceof e?t:new e(function(o){o(t)})}return new(e||(e=Promise))(function(t,o){function u(l){try{s(a.next(l))}catch(f){o(f)}}function c(l){try{s(a.throw(l))}catch(f){o(f)}}function s(l){l.done?t(l.value):i(l.value).then(u,c)}s((a=a.apply(r,n||[])).next())})},yt=globalThis&&globalThis.__generator||function(r,n){var e={label:0,sent:function(){if(t[0]&1)throw t[1];return t[1]},trys:[],ops:[]},a,i,t,o;return o={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function u(s){return function(l){return c([s,l])}}function c(s){if(a)throw new TypeError("Generator is already executing.");for(;o&&(o=0,s[0]&&(e=0)),e;)try{if(a=1,i&&(t=s[0]&2?i.return:s[0]?i.throw||((t=i.return)&&t.call(i),0):i.next)&&!(t=t.call(i,s[1])).done)return t;switch(i=0,t&&(s=[s[0]&2,t.value]),s[0]){case 0:case 1:t=s;break;case 4:return e.label++,{value:s[1],done:!1};case 5:e.label++,i=s[1],s=[0];continue;case 7:s=e.ops.pop(),e.trys.pop();continue;default:if(t=e.trys,!(t=t.length>0&&t[t.length-1])&&(s[0]===6||s[0]===2)){e=0;continue}if(s[0]===3&&(!t||s[1]>t[0]&&s[1]<t[3])){e.label=s[1];break}if(s[0]===6&&e.label<t[1]){e.label=t[1],t=s;break}if(t&&e.label<t[2]){e.label=t[2],e.ops.push(s);break}t[2]&&e.ops.pop(),e.trys.pop();continue}s=n.call(r,e)}catch(l){s=[6,l],i=0}finally{a=t=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}},Na=globalThis&&globalThis.__values||function(r){var n=typeof Symbol=="function"&&Symbol.iterator,e=n&&r[n],a=0;if(e)return e.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&a>=r.length&&(r=void 0),{value:r&&r[a++],done:!r}}};throw new TypeError(n?"Object is not iterable.":"Symbol.iterator is not defined.")},Pa=globalThis&&globalThis.__read||function(r,n){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var a=e.call(r),i,t=[],o;try{for(;(n===void 0||n-- >0)&&!(i=a.next()).done;)t.push(i.value)}catch(u){o={error:u}}finally{try{i&&!i.done&&(e=a.return)&&e.call(a)}finally{if(o)throw o.error}}return t},we=function(r){var n,e,a={};try{for(var i=Na(Object.entries(r)),t=i.next();!t.done;t=i.next()){var o=Pa(t.value,2),u=o[0],c=o[1];c!=null&&(a[u]=c.toString())}}catch(s){n={error:s}}finally{try{t&&!t.done&&(e=i.return)&&e.call(i)}finally{if(n)throw n.error}}return a},Oe=function(r){return vt(void 0,void 0,void 0,function(){var n,e,a,i,t,o;return yt(this,function(u){switch(u.label){case 0:return n=function(c){return vt(void 0,void 0,void 0,function(){var s;return yt(this,function(l){return s=new Er,s.update(Ea(c)),[2,s.digest()]})})},e=we,o={"x-amz-server-side-encryption-customer-algorithm":r.SSECustomerAlgorithm,"x-amz-server-side-encryption-customer-key":r.SSECustomerKey&&pt(r.SSECustomerKey)},a="x-amz-server-side-encryption-customer-key-md5",i=r.SSECustomerKey,i?(t=pt,[4,n(r.SSECustomerKey)]):[3,2];case 1:i=t.apply(void 0,[u.sent()]),u.label=2;case 2:return[2,e.apply(void 0,[(o[a]=i,o)])]}})})},Ct=function(r){return vt(void 0,void 0,void 0,function(){var n,e;return yt(this,function(a){switch(a.label){case 0:return n=[{}],[4,Oe(r)];case 1:return[2,Ke.apply(void 0,[Ke.apply(void 0,n.concat([a.sent()])),we(Ke({"x-amz-server-side-encryption":r.ServerSideEncryption,"x-amz-server-side-encryption-aws-kms-key-id":r.SSEKMSKeyId,"x-amz-acl":r.ACL,"cache-control":r.CacheControl,"content-disposition":r.ContentDisposition,"content-language":r.ContentLanguage,"content-encoding":r.ContentEncoding,"content-type":r.ContentType,expires:(e=r.Expires)===null||e===void 0?void 0:e.toUTCString(),"x-amz-tagging":r.Tagging},Oa(r.Metadata)))])]}})})},Oa=function(r){return r===void 0&&(r={}),Object.keys(r).reduce(function(n,e){return n["x-amz-meta-".concat(e.toLowerCase())]=r[e],n},{})},te=function(r,n){return r.pathname.replace(/\/$/,"")+"/".concat(n.split("/").map(Qn).join("/"))},Aa=/^[a-z0-9][a-z0-9\.\-]{1,61}[a-z0-9]$/,ka=/(\d+\.){3}\d+/,Ua=/\.\./,_r="s3",La=function(r,n){var e=r.region,a=r.useAccelerateEndpoint,i=r.customEndpoint,t=r.forcePathStyle,o;if(i)o=new URL(i);else if(a){if(t)throw new Error("Path style URLs are not supported with S3 Transfer Acceleration.");o=new URL("https://s3-accelerate.".concat(At(e)))}else o=new URL("https://s3.".concat(e,".").concat(At(e)));if(n?.Bucket){if(!Ia(n.Bucket))throw new Error('Invalid bucket name: "'.concat(n.Bucket,'".'));t||n.Bucket.includes(".")?o.pathname="/".concat(n.Bucket):o.host="".concat(n.Bucket,".").concat(o.host)}return{url:o}},Ia=function(r){return Aa.test(r)&&!ka.test(r)&&!Ua.test(r)},z={service:_r,endpointResolver:La,retryDecider:dn(D),computeDelay:hn,userAgentValue:Qt(),useAccelerateEndpoint:!1,uriEscapePath:!1},le=globalThis&&globalThis.__assign||function(){return le=Object.assign||function(r){for(var n,e=1,a=arguments.length;e<a;e++){n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=n[i])}return r},le.apply(this,arguments)},xt=globalThis&&globalThis.__awaiter||function(r,n,e,a){function i(t){return t instanceof e?t:new e(function(o){o(t)})}return new(e||(e=Promise))(function(t,o){function u(l){try{s(a.next(l))}catch(f){o(f)}}function c(l){try{s(a.throw(l))}catch(f){o(f)}}function s(l){l.done?t(l.value):i(l.value).then(u,c)}s((a=a.apply(r,n||[])).next())})},Nt=globalThis&&globalThis.__generator||function(r,n){var e={label:0,sent:function(){if(t[0]&1)throw t[1];return t[1]},trys:[],ops:[]},a,i,t,o;return o={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function u(s){return function(l){return c([s,l])}}function c(s){if(a)throw new TypeError("Generator is already executing.");for(;o&&(o=0,s[0]&&(e=0)),e;)try{if(a=1,i&&(t=s[0]&2?i.return:s[0]?i.throw||((t=i.return)&&t.call(i),0):i.next)&&!(t=t.call(i,s[1])).done)return t;switch(i=0,t&&(s=[s[0]&2,t.value]),s[0]){case 0:case 1:t=s;break;case 4:return e.label++,{value:s[1],done:!1};case 5:e.label++,i=s[1],s=[0];continue;case 7:s=e.ops.pop(),e.trys.pop();continue;default:if(t=e.trys,!(t=t.length>0&&t[t.length-1])&&(s[0]===6||s[0]===2)){e=0;continue}if(s[0]===3&&(!t||s[1]>t[0]&&s[1]<t[3])){e.label=s[1];break}if(s[0]===6&&e.label<t[1]){e.label=t[1],t=s;break}if(t&&e.label<t[2]){e.label=t[2],e.ops.push(s);break}t[2]&&e.ops.pop(),e.trys.pop();continue}s=n.call(r,e)}catch(l){s=[6,l],i=0}finally{a=t=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}},at=globalThis&&globalThis.__read||function(r,n){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var a=e.call(r),i,t=[],o;try{for(;(n===void 0||n-- >0)&&!(i=a.next()).done;)t.push(i.value)}catch(u){o={error:u}}finally{try{i&&!i.done&&(e=a.return)&&e.call(a)}finally{if(o)throw o.error}}return t},Ra=globalThis&&globalThis.__values||function(r){var n=typeof Symbol=="function"&&Symbol.iterator,e=n&&r[n],a=0;if(e)return e.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&a>=r.length&&(r=void 0),{value:r&&r[a++],done:!r}}};throw new TypeError(n?"Object is not iterable.":"Symbol.iterator is not defined.")},Sr=function(r,n){return xt(void 0,void 0,void 0,function(){var e,a,i;return Nt(this,function(t){switch(t.label){case 0:return[4,Oe(r)];case 1:return e=t.sent(),a=$(r,{"response-cache-control":"ResponseCacheControl","response-content-disposition":"ResponseContentDisposition","response-content-encoding":"ResponseContentEncoding","response-content-language":"ResponseContentLanguage","response-content-type":"ResponseContentType"}),i=new URL(n.url.toString()),i.pathname=te(i,r.Key),i.search=new URLSearchParams(a).toString(),[2,{method:"GET",headers:e,url:i}]}})})},Ma=function(r){return xt(void 0,void 0,void 0,function(){var n;return Nt(this,function(e){switch(e.label){case 0:return r.statusCode>=300?[4,D(r)]:[3,2];case 1:throw n=e.sent(),n;case 2:if(r.body)return[2,le(le({},$(r.headers,{DeleteMarker:["x-amz-delete-marker",qe],AcceptRanges:"accept-ranges",Expiration:"x-amz-expiration",Restore:"x-amz-restore",LastModified:["last-modified",Me],ContentLength:["content-length",Q],ETag:"etag",ChecksumCRC32:"x-amz-checksum-crc32",ChecksumCRC32C:"x-amz-checksum-crc32c",ChecksumSHA1:"x-amz-checksum-sha1",ChecksumSHA256:"x-amz-checksum-sha256",MissingMeta:["x-amz-missing-meta",Q],VersionId:"x-amz-version-id",CacheControl:"cache-control",ContentDisposition:"content-disposition",ContentEncoding:"content-encoding",ContentLanguage:"content-language",ContentRange:"content-range",ContentType:"content-type",Expires:["expires",Me],WebsiteRedirectLocation:"x-amz-website-redirect-location",ServerSideEncryption:"x-amz-server-side-encryption",SSECustomerAlgorithm:"x-amz-server-side-encryption-customer-algorithm",SSECustomerKeyMD5:"x-amz-server-side-encryption-customer-key-md5",SSEKMSKeyId:"x-amz-server-side-encryption-aws-kms-key-id",BucketKeyEnabled:["x-amz-server-side-encryption-bucket-key-enabled",qe],StorageClass:"x-amz-storage-class",RequestCharged:"x-amz-request-charged",ReplicationStatus:"x-amz-replication-status",PartsCount:["x-amz-mp-parts-count",Q],TagCount:["x-amz-tagging-count",Q],ObjectLockMode:"x-amz-object-lock-mode",ObjectLockRetainUntilDate:["x-amz-object-lock-retain-until-date",Me],ObjectLockLegalHoldStatus:"x-amz-object-lock-legal-hold"})),{Metadata:wr(r.headers),$metadata:X(r),Body:r.body})];throw new Error("Got empty response body.");case 3:return[2]}})})},Ka=W(Y,Sr,Ma,le(le({},z),{responseType:"blob"})),ja=function(r,n){return xt(void 0,void 0,void 0,function(){var e,a,i,t,o,u,c,s,l,f,h,d,g;return Nt(this,function(p){switch(p.label){case 0:return e=z.endpointResolver(r,n),[4,Sr(n,e)];case 1:a=p.sent(),i=a.url,t=a.headers,o=a.method,i.searchParams.append(ft,sr),i.searchParams.append((g=r.userAgentHeader)!==null&&g!==void 0?g:gn,r.userAgentValue);try{for(u=Ra(Object.entries(t).sort(function(v,m){var y=at(v,1),S=y[0],E=at(m,1),x=E[0];return S.localeCompare(x)})),c=u.next();!c.done;c=u.next())s=at(c.value,2),l=s[0],f=s[1],i.searchParams.append(l,f)}catch(v){h={error:v}}finally{try{c&&!c.done&&(d=u.return)&&d.call(u)}finally{if(h)throw h.error}}return[2,Vn({method:o,url:i,body:null},le(le({},z),r)).toString()]}})})},Be=globalThis&&globalThis.__assign||function(){return Be=Object.assign||function(r){for(var n,e=1,a=arguments.length;e<a;e++){n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=n[i])}return r},Be.apply(this,arguments)},Ba=globalThis&&globalThis.__awaiter||function(r,n,e,a){function i(t){return t instanceof e?t:new e(function(o){o(t)})}return new(e||(e=Promise))(function(t,o){function u(l){try{s(a.next(l))}catch(f){o(f)}}function c(l){try{s(a.throw(l))}catch(f){o(f)}}function s(l){l.done?t(l.value):i(l.value).then(u,c)}s((a=a.apply(r,n||[])).next())})},za=globalThis&&globalThis.__generator||function(r,n){var e={label:0,sent:function(){if(t[0]&1)throw t[1];return t[1]},trys:[],ops:[]},a,i,t,o;return o={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function u(s){return function(l){return c([s,l])}}function c(s){if(a)throw new TypeError("Generator is already executing.");for(;o&&(o=0,s[0]&&(e=0)),e;)try{if(a=1,i&&(t=s[0]&2?i.return:s[0]?i.throw||((t=i.return)&&t.call(i),0):i.next)&&!(t=t.call(i,s[1])).done)return t;switch(i=0,t&&(s=[s[0]&2,t.value]),s[0]){case 0:case 1:t=s;break;case 4:return e.label++,{value:s[1],done:!1};case 5:e.label++,i=s[1],s=[0];continue;case 7:s=e.ops.pop(),e.trys.pop();continue;default:if(t=e.trys,!(t=t.length>0&&t[t.length-1])&&(s[0]===6||s[0]===2)){e=0;continue}if(s[0]===3&&(!t||s[1]>t[0]&&s[1]<t[3])){e.label=s[1];break}if(s[0]===6&&e.label<t[1]){e.label=t[1],t=s;break}if(t&&e.label<t[2]){e.label=t[2],e.ops.push(s);break}t[2]&&e.ops.pop(),e.trys.pop();continue}s=n.call(r,e)}catch(l){s=[6,l],i=0}finally{a=t=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}},$a=function(r,n){var e=we({"x-amz-request-payer":r.RequestPayer,"x-amz-expected-bucket-owner":r.ExpectedBucketOwner}),a=we({"list-type":"2","continuation-token":r.ContinuationToken,delimiter:r.Delimiter,"encoding-type":r.EncodingType,"fetch-owner":r.FetchOwner,"max-keys":r.MaxKeys,prefix:r.Prefix,"start-after":r.StartAfter}),i=new URL(n.url.toString());return i.search=new URLSearchParams(a).toString(),{method:"GET",headers:e,url:i}},Fa=function(r){return Ba(void 0,void 0,void 0,function(){var n,e,a;return za(this,function(i){switch(i.label){case 0:return r.statusCode>=300?[4,D(r)]:[3,2];case 1:throw n=i.sent(),n;case 2:return[4,Se(r)];case 3:return e=i.sent(),a=$(e,{CommonPrefixes:["CommonPrefixes",function(t){return Xe(t,Ga)}],Contents:["Contents",function(t){return Xe(t,Da)}],ContinuationToken:"ContinuationToken",Delimiter:"Delimiter",EncodingType:"EncodingType",IsTruncated:["IsTruncated",qe],KeyCount:["KeyCount",Q],MaxKeys:["MaxKeys",Q],Name:"Name",NextContinuationToken:"NextContinuationToken",Prefix:"Prefix",StartAfter:"StartAfter"}),[2,Be({$metadata:X(r)},a)]}})})},Ga=function(r){return r.map(Va)},Va=function(r){return $(r,{Prefix:"Prefix"})},Da=function(r){return r.map(Ha)},Ha=function(r){return $(r,{Key:"Key",LastModified:["LastModified",Me],ETag:"ETag",ChecksumAlgorithm:["ChecksumAlgorithm",function(n){return Xe(n,qa)}],Size:["Size",Q],StorageClass:"StorageClass",Owner:["Owner",Xa]})},qa=function(r){return r.map(function(n){return String(n)})},Xa=function(r){return $(r,{DisplayName:"DisplayName",ID:"ID"})},Tr=W(Y,$a,Fa,Be(Be({},z),{responseType:"text"})),ee=globalThis&&globalThis.__assign||function(){return ee=Object.assign||function(r){for(var n,e=1,a=arguments.length;e<a;e++){n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=n[i])}return r},ee.apply(this,arguments)},Cr=globalThis&&globalThis.__awaiter||function(r,n,e,a){function i(t){return t instanceof e?t:new e(function(o){o(t)})}return new(e||(e=Promise))(function(t,o){function u(l){try{s(a.next(l))}catch(f){o(f)}}function c(l){try{s(a.throw(l))}catch(f){o(f)}}function s(l){l.done?t(l.value):i(l.value).then(u,c)}s((a=a.apply(r,n||[])).next())})},xr=globalThis&&globalThis.__generator||function(r,n){var e={label:0,sent:function(){if(t[0]&1)throw t[1];return t[1]},trys:[],ops:[]},a,i,t,o;return o={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function u(s){return function(l){return c([s,l])}}function c(s){if(a)throw new TypeError("Generator is already executing.");for(;o&&(o=0,s[0]&&(e=0)),e;)try{if(a=1,i&&(t=s[0]&2?i.return:s[0]?i.throw||((t=i.return)&&t.call(i),0):i.next)&&!(t=t.call(i,s[1])).done)return t;switch(i=0,t&&(s=[s[0]&2,t.value]),s[0]){case 0:case 1:t=s;break;case 4:return e.label++,{value:s[1],done:!1};case 5:e.label++,i=s[1],s=[0];continue;case 7:s=e.ops.pop(),e.trys.pop();continue;default:if(t=e.trys,!(t=t.length>0&&t[t.length-1])&&(s[0]===6||s[0]===2)){e=0;continue}if(s[0]===3&&(!t||s[1]>t[0]&&s[1]<t[3])){e.label=s[1];break}if(s[0]===6&&e.label<t[1]){e.label=t[1],t=s;break}if(t&&e.label<t[2]){e.label=t[2],e.ops.push(s);break}t[2]&&e.ops.pop(),e.trys.pop();continue}s=n.call(r,e)}catch(l){s=[6,l],i=0}finally{a=t=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}},Wa=function(r,n){return Cr(void 0,void 0,void 0,function(){var e,a,i,t;return xr(this,function(o){switch(o.label){case 0:return a=[{}],[4,Ct(ee(ee({},r),{ContentType:(t=r.ContentType)!==null&&t!==void 0?t:"application/octet-stream"}))];case 1:return e=ee.apply(void 0,[ee.apply(void 0,a.concat([o.sent()])),we({"content-md5":r.ContentMD5})]),i=new URL(n.url.toString()),i.pathname=te(i,r.Key),[2,{method:"PUT",headers:e,url:i,body:r.Body}]}})})},Ya=function(r){return Cr(void 0,void 0,void 0,function(){var n;return xr(this,function(e){switch(e.label){case 0:return r.statusCode>=300?[4,D(r)]:[3,2];case 1:throw n=e.sent(),n;case 2:return[2,ee(ee({},$(r.headers,{ETag:"etag",VersionId:"x-amz-version-id"})),{$metadata:X(r)})]}})})},Za=W(Y,Wa,Ya,ee(ee({},z),{responseType:"text"})),ze=globalThis&&globalThis.__assign||function(){return ze=Object.assign||function(r){for(var n,e=1,a=arguments.length;e<a;e++){n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=n[i])}return r},ze.apply(this,arguments)},Nr=globalThis&&globalThis.__awaiter||function(r,n,e,a){function i(t){return t instanceof e?t:new e(function(o){o(t)})}return new(e||(e=Promise))(function(t,o){function u(l){try{s(a.next(l))}catch(f){o(f)}}function c(l){try{s(a.throw(l))}catch(f){o(f)}}function s(l){l.done?t(l.value):i(l.value).then(u,c)}s((a=a.apply(r,n||[])).next())})},Pr=globalThis&&globalThis.__generator||function(r,n){var e={label:0,sent:function(){if(t[0]&1)throw t[1];return t[1]},trys:[],ops:[]},a,i,t,o;return o={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function u(s){return function(l){return c([s,l])}}function c(s){if(a)throw new TypeError("Generator is already executing.");for(;o&&(o=0,s[0]&&(e=0)),e;)try{if(a=1,i&&(t=s[0]&2?i.return:s[0]?i.throw||((t=i.return)&&t.call(i),0):i.next)&&!(t=t.call(i,s[1])).done)return t;switch(i=0,t&&(s=[s[0]&2,t.value]),s[0]){case 0:case 1:t=s;break;case 4:return e.label++,{value:s[1],done:!1};case 5:e.label++,i=s[1],s=[0];continue;case 7:s=e.ops.pop(),e.trys.pop();continue;default:if(t=e.trys,!(t=t.length>0&&t[t.length-1])&&(s[0]===6||s[0]===2)){e=0;continue}if(s[0]===3&&(!t||s[1]>t[0]&&s[1]<t[3])){e.label=s[1];break}if(s[0]===6&&e.label<t[1]){e.label=t[1],t=s;break}if(t&&e.label<t[2]){e.label=t[2],e.ops.push(s);break}t[2]&&e.ops.pop(),e.trys.pop();continue}s=n.call(r,e)}catch(l){s=[6,l],i=0}finally{a=t=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}},Ja=function(r,n){return Nr(void 0,void 0,void 0,function(){var e,a;return Pr(this,function(i){switch(i.label){case 0:return[4,Ct(r)];case 1:return e=i.sent(),a=new URL(n.url.toString()),a.pathname=te(a,r.Key),a.search="uploads",[2,{method:"POST",headers:e,url:a}]}})})},Qa=function(r){return Nr(void 0,void 0,void 0,function(){var n,e,a;return Pr(this,function(i){switch(i.label){case 0:return r.statusCode>=300?[4,D(r)]:[3,2];case 1:throw n=i.sent(),n;case 2:return[4,Se(r)];case 3:return e=i.sent(),a=$(e,{UploadId:"UploadId"}),[2,ze({$metadata:X(r)},a)]}})})},Or=W(Y,Ja,Qa,ze(ze({},z),{responseType:"text"})),ce=globalThis&&globalThis.__assign||function(){return ce=Object.assign||function(r){for(var n,e=1,a=arguments.length;e<a;e++){n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=n[i])}return r},ce.apply(this,arguments)},Ar=globalThis&&globalThis.__awaiter||function(r,n,e,a){function i(t){return t instanceof e?t:new e(function(o){o(t)})}return new(e||(e=Promise))(function(t,o){function u(l){try{s(a.next(l))}catch(f){o(f)}}function c(l){try{s(a.throw(l))}catch(f){o(f)}}function s(l){l.done?t(l.value):i(l.value).then(u,c)}s((a=a.apply(r,n||[])).next())})},kr=globalThis&&globalThis.__generator||function(r,n){var e={label:0,sent:function(){if(t[0]&1)throw t[1];return t[1]},trys:[],ops:[]},a,i,t,o;return o={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function u(s){return function(l){return c([s,l])}}function c(s){if(a)throw new TypeError("Generator is already executing.");for(;o&&(o=0,s[0]&&(e=0)),e;)try{if(a=1,i&&(t=s[0]&2?i.return:s[0]?i.throw||((t=i.return)&&t.call(i),0):i.next)&&!(t=t.call(i,s[1])).done)return t;switch(i=0,t&&(s=[s[0]&2,t.value]),s[0]){case 0:case 1:t=s;break;case 4:return e.label++,{value:s[1],done:!1};case 5:e.label++,i=s[1],s=[0];continue;case 7:s=e.ops.pop(),e.trys.pop();continue;default:if(t=e.trys,!(t=t.length>0&&t[t.length-1])&&(s[0]===6||s[0]===2)){e=0;continue}if(s[0]===3&&(!t||s[1]>t[0]&&s[1]<t[3])){e.label=s[1];break}if(s[0]===6&&e.label<t[1]){e.label=t[1],t=s;break}if(t&&e.label<t[2]){e.label=t[2],e.ops.push(s);break}t[2]&&e.ops.pop(),e.trys.pop();continue}s=n.call(r,e)}catch(l){s=[6,l],i=0}finally{a=t=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}},es=function(r,n){return Ar(void 0,void 0,void 0,function(){var e,a,i;return kr(this,function(t){switch(t.label){case 0:return a=[{}],[4,Oe(r)];case 1:return e=ce.apply(void 0,[ce.apply(void 0,a.concat([t.sent()])),we({"content-md5":r.ContentMD5})]),e["content-type"]="application/octet-stream",i=new URL(n.url.toString()),i.pathname=te(i,r.Key),i.search=new URLSearchParams({partNumber:r.PartNumber+"",uploadId:r.UploadId}).toString(),[2,{method:"PUT",headers:e,url:i,body:r.Body}]}})})},ts=function(r){return Ar(void 0,void 0,void 0,function(){var n;return kr(this,function(e){switch(e.label){case 0:return r.statusCode>=300?[4,D(r)]:[3,2];case 1:throw n=e.sent(),n;case 2:return[2,ce(ce({},$(r.headers,{ETag:"etag"})),{$metadata:X(r)})]}})})},Ur=W(Y,es,ts,ce(ce({},z),{responseType:"text"})),Ee=globalThis&&globalThis.__assign||function(){return Ee=Object.assign||function(r){for(var n,e=1,a=arguments.length;e<a;e++){n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=n[i])}return r},Ee.apply(this,arguments)},Qe=globalThis&&globalThis.__awaiter||function(r,n,e,a){function i(t){return t instanceof e?t:new e(function(o){o(t)})}return new(e||(e=Promise))(function(t,o){function u(l){try{s(a.next(l))}catch(f){o(f)}}function c(l){try{s(a.throw(l))}catch(f){o(f)}}function s(l){l.done?t(l.value):i(l.value).then(u,c)}s((a=a.apply(r,n||[])).next())})},et=globalThis&&globalThis.__generator||function(r,n){var e={label:0,sent:function(){if(t[0]&1)throw t[1];return t[1]},trys:[],ops:[]},a,i,t,o;return o={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function u(s){return function(l){return c([s,l])}}function c(s){if(a)throw new TypeError("Generator is already executing.");for(;o&&(o=0,s[0]&&(e=0)),e;)try{if(a=1,i&&(t=s[0]&2?i.return:s[0]?i.throw||((t=i.return)&&t.call(i),0):i.next)&&!(t=t.call(i,s[1])).done)return t;switch(i=0,t&&(s=[s[0]&2,t.value]),s[0]){case 0:case 1:t=s;break;case 4:return e.label++,{value:s[1],done:!1};case 5:e.label++,i=s[1],s=[0];continue;case 7:s=e.ops.pop(),e.trys.pop();continue;default:if(t=e.trys,!(t=t.length>0&&t[t.length-1])&&(s[0]===6||s[0]===2)){e=0;continue}if(s[0]===3&&(!t||s[1]>t[0]&&s[1]<t[3])){e.label=s[1];break}if(s[0]===6&&e.label<t[1]){e.label=t[1],t=s;break}if(t&&e.label<t[2]){e.label=t[2],e.ops.push(s);break}t[2]&&e.ops.pop(),e.trys.pop();continue}s=n.call(r,e)}catch(l){s=[6,l],i=0}finally{a=t=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}},Lr="Invalid parameter for ComplteMultipartUpload API",rs=function(r,n){return Qe(void 0,void 0,void 0,function(){var e,a;return et(this,function(i){switch(i.label){case 0:return[4,Oe(r)];case 1:return e=i.sent(),e["content-type"]="application/xml",a=new URL(n.url.toString()),a.pathname=te(a,r.Key),a.search=new URLSearchParams({uploadId:r.UploadId}).toString(),[2,{method:"POST",headers:e,url:a,body:'<?xml version="1.0" encoding="UTF-8"?>'+ns(r.MultipartUpload)}]}})})},ns=function(r){var n;if(!(!((n=r.Parts)===null||n===void 0)&&n.length))throw new Error("".concat(Lr,": ").concat(r));return'<CompleteMultipartUpload xmlns="http://s3.amazonaws.com/doc/2006-03-01/">'.concat(r.Parts.map(is).join(""),"</CompleteMultipartUpload>")},is=function(r){if(!r.ETag||r.PartNumber==null)throw new Error("".concat(Lr,": ").concat(r));return"<Part><ETag>".concat(r.ETag,"</ETag><PartNumber>").concat(r.PartNumber,"</PartNumber></Part>")},as=function(r){return Qe(void 0,void 0,void 0,function(){var n,e;return et(this,function(a){switch(a.label){case 0:return[4,Se(r)];case 1:return n=a.sent(),n.Code!==void 0&&n.Message!==void 0?[4,D(Ee(Ee({},r),{statusCode:500}))]:[3,3];case 2:throw e=a.sent(),e.$metadata.httpStatusCode=r.statusCode,e;case 3:return[2,n]}})})},ss=function(r){return Qe(void 0,void 0,void 0,function(){var n,e,a;return et(this,function(i){switch(i.label){case 0:return r.statusCode>=300?[4,D(r)]:[3,2];case 1:throw n=i.sent(),n;case 2:return[4,as(r)];case 3:return e=i.sent(),a=$(e,{ETag:"ETag",Key:"Key",Location:"Location"}),[2,Ee({$metadata:X(r)},a)]}})})},os=function(r,n){return Qe(void 0,void 0,void 0,function(){var e,a;return et(this,function(i){switch(i.label){case 0:return r.statusCode!==200?[3,2]:r.body?[4,Se(r)]:[2,!0];case 1:return e=i.sent(),e.Code!==void 0&&e.Message!==void 0?[2,!0]:[2,!1];case 2:return a=z.retryDecider,[2,a(r,n)]}})})},Ir=W(Y,rs,ss,Ee(Ee({},z),{responseType:"text",retryDecider:os})),$e=globalThis&&globalThis.__assign||function(){return $e=Object.assign||function(r){for(var n,e=1,a=arguments.length;e<a;e++){n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=n[i])}return r},$e.apply(this,arguments)},Rr=globalThis&&globalThis.__awaiter||function(r,n,e,a){function i(t){return t instanceof e?t:new e(function(o){o(t)})}return new(e||(e=Promise))(function(t,o){function u(l){try{s(a.next(l))}catch(f){o(f)}}function c(l){try{s(a.throw(l))}catch(f){o(f)}}function s(l){l.done?t(l.value):i(l.value).then(u,c)}s((a=a.apply(r,n||[])).next())})},Mr=globalThis&&globalThis.__generator||function(r,n){var e={label:0,sent:function(){if(t[0]&1)throw t[1];return t[1]},trys:[],ops:[]},a,i,t,o;return o={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function u(s){return function(l){return c([s,l])}}function c(s){if(a)throw new TypeError("Generator is already executing.");for(;o&&(o=0,s[0]&&(e=0)),e;)try{if(a=1,i&&(t=s[0]&2?i.return:s[0]?i.throw||((t=i.return)&&t.call(i),0):i.next)&&!(t=t.call(i,s[1])).done)return t;switch(i=0,t&&(s=[s[0]&2,t.value]),s[0]){case 0:case 1:t=s;break;case 4:return e.label++,{value:s[1],done:!1};case 5:e.label++,i=s[1],s=[0];continue;case 7:s=e.ops.pop(),e.trys.pop();continue;default:if(t=e.trys,!(t=t.length>0&&t[t.length-1])&&(s[0]===6||s[0]===2)){e=0;continue}if(s[0]===3&&(!t||s[1]>t[0]&&s[1]<t[3])){e.label=s[1];break}if(s[0]===6&&e.label<t[1]){e.label=t[1],t=s;break}if(t&&e.label<t[2]){e.label=t[2],e.ops.push(s);break}t[2]&&e.ops.pop(),e.trys.pop();continue}s=n.call(r,e)}catch(l){s=[6,l],i=0}finally{a=t=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}},us=function(r,n){return Rr(void 0,void 0,void 0,function(){var e,a;return Mr(this,function(i){switch(i.label){case 0:return[4,Oe(r)];case 1:return e=i.sent(),a=new URL(n.url.toString()),a.pathname=te(a,r.Key),a.search=new URLSearchParams({uploadId:r.UploadId}).toString(),[2,{method:"GET",headers:e,url:a}]}})})},ls=function(r){return Rr(void 0,void 0,void 0,function(){var n,e,a;return Mr(this,function(i){switch(i.label){case 0:return r.statusCode>=300?[4,D(r)]:[3,2];case 1:throw n=i.sent(),n;case 2:return[4,Se(r)];case 3:return e=i.sent(),a=$(e,{UploadId:"UploadId",Parts:["Part",function(t){return Xe(t,cs)}]}),[2,$e({$metadata:X(r)},a)]}})})},cs=function(r){return r.map(function(n){return $(n,{PartNumber:["PartNumber",Q],ETag:"ETag",Size:["Size",Q]})})},Kr=W(Y,us,ls,$e($e({},z),{responseType:"text"})),We=globalThis&&globalThis.__assign||function(){return We=Object.assign||function(r){for(var n,e=1,a=arguments.length;e<a;e++){n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=n[i])}return r},We.apply(this,arguments)},fs=globalThis&&globalThis.__awaiter||function(r,n,e,a){function i(t){return t instanceof e?t:new e(function(o){o(t)})}return new(e||(e=Promise))(function(t,o){function u(l){try{s(a.next(l))}catch(f){o(f)}}function c(l){try{s(a.throw(l))}catch(f){o(f)}}function s(l){l.done?t(l.value):i(l.value).then(u,c)}s((a=a.apply(r,n||[])).next())})},ds=globalThis&&globalThis.__generator||function(r,n){var e={label:0,sent:function(){if(t[0]&1)throw t[1];return t[1]},trys:[],ops:[]},a,i,t,o;return o={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function u(s){return function(l){return c([s,l])}}function c(s){if(a)throw new TypeError("Generator is already executing.");for(;o&&(o=0,s[0]&&(e=0)),e;)try{if(a=1,i&&(t=s[0]&2?i.return:s[0]?i.throw||((t=i.return)&&t.call(i),0):i.next)&&!(t=t.call(i,s[1])).done)return t;switch(i=0,t&&(s=[s[0]&2,t.value]),s[0]){case 0:case 1:t=s;break;case 4:return e.label++,{value:s[1],done:!1};case 5:e.label++,i=s[1],s=[0];continue;case 7:s=e.ops.pop(),e.trys.pop();continue;default:if(t=e.trys,!(t=t.length>0&&t[t.length-1])&&(s[0]===6||s[0]===2)){e=0;continue}if(s[0]===3&&(!t||s[1]>t[0]&&s[1]<t[3])){e.label=s[1];break}if(s[0]===6&&e.label<t[1]){e.label=t[1],t=s;break}if(t&&e.label<t[2]){e.label=t[2],e.ops.push(s);break}t[2]&&e.ops.pop(),e.trys.pop();continue}s=n.call(r,e)}catch(l){s=[6,l],i=0}finally{a=t=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}},hs=function(r,n){var e=new URL(n.url.toString());return e.pathname=te(e,r.Key),e.search=new URLSearchParams({uploadId:r.UploadId}).toString(),{method:"DELETE",headers:{},url:e}},gs=function(r){return fs(void 0,void 0,void 0,function(){var n;return ds(this,function(e){switch(e.label){case 0:return r.statusCode>=300?[4,D(r)]:[3,2];case 1:throw n=e.sent(),n;case 2:return[2,{$metadata:X(r)}]}})})},jr=W(Y,hs,gs,We(We({},z),{responseType:"text"})),Ne=globalThis&&globalThis.__assign||function(){return Ne=Object.assign||function(r){for(var n,e=1,a=arguments.length;e<a;e++){n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=n[i])}return r},Ne.apply(this,arguments)},Br=globalThis&&globalThis.__awaiter||function(r,n,e,a){function i(t){return t instanceof e?t:new e(function(o){o(t)})}return new(e||(e=Promise))(function(t,o){function u(l){try{s(a.next(l))}catch(f){o(f)}}function c(l){try{s(a.throw(l))}catch(f){o(f)}}function s(l){l.done?t(l.value):i(l.value).then(u,c)}s((a=a.apply(r,n||[])).next())})},zr=globalThis&&globalThis.__generator||function(r,n){var e={label:0,sent:function(){if(t[0]&1)throw t[1];return t[1]},trys:[],ops:[]},a,i,t,o;return o={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function u(s){return function(l){return c([s,l])}}function c(s){if(a)throw new TypeError("Generator is already executing.");for(;o&&(o=0,s[0]&&(e=0)),e;)try{if(a=1,i&&(t=s[0]&2?i.return:s[0]?i.throw||((t=i.return)&&t.call(i),0):i.next)&&!(t=t.call(i,s[1])).done)return t;switch(i=0,t&&(s=[s[0]&2,t.value]),s[0]){case 0:case 1:t=s;break;case 4:return e.label++,{value:s[1],done:!1};case 5:e.label++,i=s[1],s=[0];continue;case 7:s=e.ops.pop(),e.trys.pop();continue;default:if(t=e.trys,!(t=t.length>0&&t[t.length-1])&&(s[0]===6||s[0]===2)){e=0;continue}if(s[0]===3&&(!t||s[1]>t[0]&&s[1]<t[3])){e.label=s[1];break}if(s[0]===6&&e.label<t[1]){e.label=t[1],t=s;break}if(t&&e.label<t[2]){e.label=t[2],e.ops.push(s);break}t[2]&&e.ops.pop(),e.trys.pop();continue}s=n.call(r,e)}catch(l){s=[6,l],i=0}finally{a=t=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}},ps=function(r,n){return Br(void 0,void 0,void 0,function(){var e,a,i;return zr(this,function(t){switch(t.label){case 0:return a=[{}],[4,Ct(r)];case 1:return e=Ne.apply(void 0,[Ne.apply(void 0,a.concat([t.sent()])),we({"x-amz-copy-source":r.CopySource,"x-amz-metadata-directive":r.MetadataDirective})]),i=new URL(n.url.toString()),i.pathname=te(i,r.Key),[2,{method:"PUT",headers:e,url:i}]}})})},vs=function(r){return Br(void 0,void 0,void 0,function(){var n;return zr(this,function(e){switch(e.label){case 0:return r.statusCode>=300?[4,D(r)]:[3,2];case 1:throw n=e.sent(),n;case 2:return[4,Se(r)];case 3:return e.sent(),[2,{$metadata:X(r)}]}})})},ys=W(Y,ps,vs,Ne(Ne({},z),{responseType:"text"})),me=globalThis&&globalThis.__assign||function(){return me=Object.assign||function(r){for(var n,e=1,a=arguments.length;e<a;e++){n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=n[i])}return r},me.apply(this,arguments)},$r=globalThis&&globalThis.__awaiter||function(r,n,e,a){function i(t){return t instanceof e?t:new e(function(o){o(t)})}return new(e||(e=Promise))(function(t,o){function u(l){try{s(a.next(l))}catch(f){o(f)}}function c(l){try{s(a.throw(l))}catch(f){o(f)}}function s(l){l.done?t(l.value):i(l.value).then(u,c)}s((a=a.apply(r,n||[])).next())})},Fr=globalThis&&globalThis.__generator||function(r,n){var e={label:0,sent:function(){if(t[0]&1)throw t[1];return t[1]},trys:[],ops:[]},a,i,t,o;return o={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function u(s){return function(l){return c([s,l])}}function c(s){if(a)throw new TypeError("Generator is already executing.");for(;o&&(o=0,s[0]&&(e=0)),e;)try{if(a=1,i&&(t=s[0]&2?i.return:s[0]?i.throw||((t=i.return)&&t.call(i),0):i.next)&&!(t=t.call(i,s[1])).done)return t;switch(i=0,t&&(s=[s[0]&2,t.value]),s[0]){case 0:case 1:t=s;break;case 4:return e.label++,{value:s[1],done:!1};case 5:e.label++,i=s[1],s=[0];continue;case 7:s=e.ops.pop(),e.trys.pop();continue;default:if(t=e.trys,!(t=t.length>0&&t[t.length-1])&&(s[0]===6||s[0]===2)){e=0;continue}if(s[0]===3&&(!t||s[1]>t[0]&&s[1]<t[3])){e.label=s[1];break}if(s[0]===6&&e.label<t[1]){e.label=t[1],t=s;break}if(t&&e.label<t[2]){e.label=t[2],e.ops.push(s);break}t[2]&&e.ops.pop(),e.trys.pop();continue}s=n.call(r,e)}catch(l){s=[6,l],i=0}finally{a=t=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}},bs=function(r,n){return $r(void 0,void 0,void 0,function(){var e,a;return Fr(this,function(i){switch(i.label){case 0:return[4,Oe(r)];case 1:return e=i.sent(),a=new URL(n.url.toString()),a.pathname=te(a,r.Key),[2,{method:"HEAD",headers:e,url:a}]}})})},ms=function(r){return $r(void 0,void 0,void 0,function(){var n,e;return Fr(this,function(a){switch(a.label){case 0:return r.statusCode>=300?[4,D(r)]:[3,2];case 1:throw n=a.sent(),n;case 2:return e=me(me({},$(r.headers,{ContentLength:["content-length",Q],ContentType:"content-type",ETag:"etag",LastModified:["last-modified",Me],VersionId:"x-amz-version-id"})),{Metadata:wr(r.headers)}),[2,me({$metadata:X(r)},e)]}})})},jt=W(Y,bs,ms,me(me({},z),{responseType:"text"})),Pe=globalThis&&globalThis.__assign||function(){return Pe=Object.assign||function(r){for(var n,e=1,a=arguments.length;e<a;e++){n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=n[i])}return r},Pe.apply(this,arguments)},ws=globalThis&&globalThis.__awaiter||function(r,n,e,a){function i(t){return t instanceof e?t:new e(function(o){o(t)})}return new(e||(e=Promise))(function(t,o){function u(l){try{s(a.next(l))}catch(f){o(f)}}function c(l){try{s(a.throw(l))}catch(f){o(f)}}function s(l){l.done?t(l.value):i(l.value).then(u,c)}s((a=a.apply(r,n||[])).next())})},Es=globalThis&&globalThis.__generator||function(r,n){var e={label:0,sent:function(){if(t[0]&1)throw t[1];return t[1]},trys:[],ops:[]},a,i,t,o;return o={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function u(s){return function(l){return c([s,l])}}function c(s){if(a)throw new TypeError("Generator is already executing.");for(;o&&(o=0,s[0]&&(e=0)),e;)try{if(a=1,i&&(t=s[0]&2?i.return:s[0]?i.throw||((t=i.return)&&t.call(i),0):i.next)&&!(t=t.call(i,s[1])).done)return t;switch(i=0,t&&(s=[s[0]&2,t.value]),s[0]){case 0:case 1:t=s;break;case 4:return e.label++,{value:s[1],done:!1};case 5:e.label++,i=s[1],s=[0];continue;case 7:s=e.ops.pop(),e.trys.pop();continue;default:if(t=e.trys,!(t=t.length>0&&t[t.length-1])&&(s[0]===6||s[0]===2)){e=0;continue}if(s[0]===3&&(!t||s[1]>t[0]&&s[1]<t[3])){e.label=s[1];break}if(s[0]===6&&e.label<t[1]){e.label=t[1],t=s;break}if(t&&e.label<t[2]){e.label=t[2],e.ops.push(s);break}t[2]&&e.ops.pop(),e.trys.pop();continue}s=n.call(r,e)}catch(l){s=[6,l],i=0}finally{a=t=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}},_s=function(r,n){var e=new URL(n.url.toString());return e.pathname=te(e,r.Key),{method:"DELETE",headers:{},url:e}},Ss=function(r){return ws(void 0,void 0,void 0,function(){var n,e;return Es(this,function(a){switch(a.label){case 0:return r.statusCode>=300?[4,D(r)]:[3,2];case 1:throw n=a.sent(),n;case 2:return e=$(r.headers,{DeleteMarker:["x-amz-delete-marker",qe],VersionId:"x-amz-version-id",RequestCharged:"x-amz-request-charged"}),[2,Pe(Pe({},e),{$metadata:X(r)})]}})})},Ts=W(Y,_s,Ss,Pe(Pe({},z),{responseType:"text"})),J;(function(r){r.NO_CREDENTIALS="No credentials",r.NO_SRC_KEY='source param should be an object with the property "key" with value of type string',r.NO_DEST_KEY='destination param should be an object with the property "key" with value of type string',r.INVALID_BLOB="Object must be an instance of Blob"})(J||(J={}));var Bt;(function(r){r.CLEANUP_FAILED="Multipart copy clean up failed",r.NO_OBJECT_FOUND="Object does not exist",r.INVALID_QUEUESIZE="Queue size must be a positive number",r.NO_COPYSOURCE="You must specify a copy source",r.MAX_NUM_PARTS_EXCEEDED="Only a maximum of 10000 parts are allowed"})(Bt||(Bt={}));var zt;(function(r){r.UPLOAD_PAUSED_MESSAGE="paused"})(zt||(zt={}));var Cs=typeof Symbol<"u"&&typeof Symbol.for=="function"?Symbol.for("amplify_default"):"@@amplify_default",xs="http://localhost:20005",Ie="__uploadInProgress",Ns=function(r){if(typeof r=="string")return r.length;if(As(r))return r.byteLength;if(Os(r))return r.size;throw new Error("Cannot determine byte length of "+r)},I=function(r,n,e,a,i){if(r){var t={attrs:e};a&&(t.metrics=a),er.dispatch("storage",{event:n,data:t,message:i},"Storage",Cs)}},Ps=function(r){return typeof r<"u"&&r instanceof File},Os=function(r){return typeof r<"u"&&r instanceof Blob},As=function(r){return typeof r<"u"&&r instanceof ArrayBuffer},je=globalThis&&globalThis.__assign||function(){return je=Object.assign||function(r){for(var n,e=1,a=arguments.length;e<a;e++){n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=n[i])}return r},je.apply(this,arguments)},ks=globalThis&&globalThis.__awaiter||function(r,n,e,a){function i(t){return t instanceof e?t:new e(function(o){o(t)})}return new(e||(e=Promise))(function(t,o){function u(l){try{s(a.next(l))}catch(f){o(f)}}function c(l){try{s(a.throw(l))}catch(f){o(f)}}function s(l){l.done?t(l.value):i(l.value).then(u,c)}s((a=a.apply(r,n||[])).next())})},Us=globalThis&&globalThis.__generator||function(r,n){var e={label:0,sent:function(){if(t[0]&1)throw t[1];return t[1]},trys:[],ops:[]},a,i,t,o;return o={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function u(s){return function(l){return c([s,l])}}function c(s){if(a)throw new TypeError("Generator is already executing.");for(;o&&(o=0,s[0]&&(e=0)),e;)try{if(a=1,i&&(t=s[0]&2?i.return:s[0]?i.throw||((t=i.return)&&t.call(i),0):i.next)&&!(t=t.call(i,s[1])).done)return t;switch(i=0,t&&(s=[s[0]&2,t.value]),s[0]){case 0:case 1:t=s;break;case 4:return e.label++,{value:s[1],done:!1};case 5:e.label++,i=s[1],s=[0];continue;case 7:s=e.ops.pop(),e.trys.pop();continue;default:if(t=e.trys,!(t=t.length>0&&t[t.length-1])&&(s[0]===6||s[0]===2)){e=0;continue}if(s[0]===3&&(!t||s[1]>t[0]&&s[1]<t[3])){e.label=s[1];break}if(s[0]===6&&e.label<t[1]){e.label=t[1],t=s;break}if(t&&e.label<t[2]){e.label=t[2],e.ops.push(s);break}t[2]&&e.ops.pop(),e.trys.pop();continue}s=n.call(r,e)}catch(l){s=[6,l],i=0}finally{a=t=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}},$t=new _e("S3ClientUtils"),Ft={accessKeyId:"",secretAccessKey:""},Gr=function(r){var n=r.credentials,e=r.level,a=r.customPrefix,i=r.identityId,t=a||{},o=i||n.identityId,u=(t.private!==void 0?t.private:"private/")+o+"/",c=(t.protected!==void 0?t.protected:"protected/")+o+"/",s=t.public!==void 0?t.public:"public/";switch(e){case"private":return u;case"protected":return c;default:return s}},Vr=function(){return ks(void 0,void 0,void 0,function(){var r,n,e;return Us(this,function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),[4,Ce.get()];case 1:return r=a.sent(),r?(n=Ce.shear(r),$t.debug("credentials provider get credentials",n),[2,n]):[2,Ft];case 2:return e=a.sent(),$t.warn("credentials provider error",e),[2,Ft];case 3:return[2]}})})},ye=function(r){if(!r.region)throw new Error("Region is missing.");return je(je(je({},r),{region:r.region,credentials:r.credentials?function(){return Promise.resolve(r.credentials)}:Vr,userAgentValue:Qt({category:pn.Storage,action:r.storageAction})}),r.dangerouslyConnectToHttpEndpointForTesting?{customEndpoint:xs,forcePathStyle:!0}:{})},Dr=1024*1024,Ls=1024*Dr,Is=1024*Ls,Ye=5*Dr,Hr=5*Is,Rs=1e4,bt=4,qr=function(r){for(var n=Ye,e=Math.ceil(r/n);e>Rs;)n*=2,e=Math.ceil(r/n);return n},Pt={exports:{}},xe=typeof Reflect=="object"?Reflect:null,Gt=xe&&typeof xe.apply=="function"?xe.apply:function(n,e,a){return Function.prototype.apply.call(n,e,a)},De;xe&&typeof xe.ownKeys=="function"?De=xe.ownKeys:Object.getOwnPropertySymbols?De=function(n){return Object.getOwnPropertyNames(n).concat(Object.getOwnPropertySymbols(n))}:De=function(n){return Object.getOwnPropertyNames(n)};function Ms(r){console&&console.warn&&console.warn(r)}var Xr=Number.isNaN||function(n){return n!==n};function w(){w.init.call(this)}Pt.exports=w;Pt.exports.once=zs;w.EventEmitter=w;w.prototype._events=void 0;w.prototype._eventsCount=0;w.prototype._maxListeners=void 0;var Vt=10;function tt(r){if(typeof r!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof r)}Object.defineProperty(w,"defaultMaxListeners",{enumerable:!0,get:function(){return Vt},set:function(r){if(typeof r!="number"||r<0||Xr(r))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+r+".");Vt=r}});w.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};w.prototype.setMaxListeners=function(n){if(typeof n!="number"||n<0||Xr(n))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+n+".");return this._maxListeners=n,this};function Wr(r){return r._maxListeners===void 0?w.defaultMaxListeners:r._maxListeners}w.prototype.getMaxListeners=function(){return Wr(this)};w.prototype.emit=function(n){for(var e=[],a=1;a<arguments.length;a++)e.push(arguments[a]);var i=n==="error",t=this._events;if(t!==void 0)i=i&&t.error===void 0;else if(!i)return!1;if(i){var o;if(e.length>0&&(o=e[0]),o instanceof Error)throw o;var u=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw u.context=o,u}var c=t[n];if(c===void 0)return!1;if(typeof c=="function")Gt(c,this,e);else for(var s=c.length,l=en(c,s),a=0;a<s;++a)Gt(l[a],this,e);return!0};function Yr(r,n,e,a){var i,t,o;if(tt(e),t=r._events,t===void 0?(t=r._events=Object.create(null),r._eventsCount=0):(t.newListener!==void 0&&(r.emit("newListener",n,e.listener?e.listener:e),t=r._events),o=t[n]),o===void 0)o=t[n]=e,++r._eventsCount;else if(typeof o=="function"?o=t[n]=a?[e,o]:[o,e]:a?o.unshift(e):o.push(e),i=Wr(r),i>0&&o.length>i&&!o.warned){o.warned=!0;var u=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(n)+" listeners added. Use emitter.setMaxListeners() to increase limit");u.name="MaxListenersExceededWarning",u.emitter=r,u.type=n,u.count=o.length,Ms(u)}return r}w.prototype.addListener=function(n,e){return Yr(this,n,e,!1)};w.prototype.on=w.prototype.addListener;w.prototype.prependListener=function(n,e){return Yr(this,n,e,!0)};function Ks(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function Zr(r,n,e){var a={fired:!1,wrapFn:void 0,target:r,type:n,listener:e},i=Ks.bind(a);return i.listener=e,a.wrapFn=i,i}w.prototype.once=function(n,e){return tt(e),this.on(n,Zr(this,n,e)),this};w.prototype.prependOnceListener=function(n,e){return tt(e),this.prependListener(n,Zr(this,n,e)),this};w.prototype.removeListener=function(n,e){var a,i,t,o,u;if(tt(e),i=this._events,i===void 0)return this;if(a=i[n],a===void 0)return this;if(a===e||a.listener===e)--this._eventsCount===0?this._events=Object.create(null):(delete i[n],i.removeListener&&this.emit("removeListener",n,a.listener||e));else if(typeof a!="function"){for(t=-1,o=a.length-1;o>=0;o--)if(a[o]===e||a[o].listener===e){u=a[o].listener,t=o;break}if(t<0)return this;t===0?a.shift():js(a,t),a.length===1&&(i[n]=a[0]),i.removeListener!==void 0&&this.emit("removeListener",n,u||e)}return this};w.prototype.off=w.prototype.removeListener;w.prototype.removeAllListeners=function(n){var e,a,i;if(a=this._events,a===void 0)return this;if(a.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):a[n]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete a[n]),this;if(arguments.length===0){var t=Object.keys(a),o;for(i=0;i<t.length;++i)o=t[i],o!=="removeListener"&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(e=a[n],typeof e=="function")this.removeListener(n,e);else if(e!==void 0)for(i=e.length-1;i>=0;i--)this.removeListener(n,e[i]);return this};function Jr(r,n,e){var a=r._events;if(a===void 0)return[];var i=a[n];return i===void 0?[]:typeof i=="function"?e?[i.listener||i]:[i]:e?Bs(i):en(i,i.length)}w.prototype.listeners=function(n){return Jr(this,n,!0)};w.prototype.rawListeners=function(n){return Jr(this,n,!1)};w.listenerCount=function(r,n){return typeof r.listenerCount=="function"?r.listenerCount(n):Qr.call(r,n)};w.prototype.listenerCount=Qr;function Qr(r){var n=this._events;if(n!==void 0){var e=n[r];if(typeof e=="function")return 1;if(e!==void 0)return e.length}return 0}w.prototype.eventNames=function(){return this._eventsCount>0?De(this._events):[]};function en(r,n){for(var e=new Array(n),a=0;a<n;++a)e[a]=r[a];return e}function js(r,n){for(;n+1<r.length;n++)r[n]=r[n+1];r.pop()}function Bs(r){for(var n=new Array(r.length),e=0;e<n.length;++e)n[e]=r[e].listener||r[e];return n}function zs(r,n){return new Promise(function(e,a){function i(o){r.removeListener(n,t),a(o)}function t(){typeof r.removeListener=="function"&&r.removeListener("error",i),e([].slice.call(arguments))}tn(r,n,t,{once:!0}),n!=="error"&&$s(r,i,{once:!0})})}function $s(r,n,e){typeof r.on=="function"&&tn(r,"error",n,e)}function tn(r,n,e,a){if(typeof r.on=="function")a.once?r.once(n,e):r.on(n,e);else if(typeof r.addEventListener=="function")r.addEventListener(n,function i(t){a.once&&r.removeEventListener(n,i),e(t)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof r)}var mt=Pt.exports,Fs=globalThis&&globalThis.__awaiter||function(r,n,e,a){function i(t){return t instanceof e?t:new e(function(o){o(t)})}return new(e||(e=Promise))(function(t,o){function u(l){try{s(a.next(l))}catch(f){o(f)}}function c(l){try{s(a.throw(l))}catch(f){o(f)}}function s(l){l.done?t(l.value):i(l.value).then(u,c)}s((a=a.apply(r,n||[])).next())})},Gs=globalThis&&globalThis.__generator||function(r,n){var e={label:0,sent:function(){if(t[0]&1)throw t[1];return t[1]},trys:[],ops:[]},a,i,t,o;return o={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function u(s){return function(l){return c([s,l])}}function c(s){if(a)throw new TypeError("Generator is already executing.");for(;o&&(o=0,s[0]&&(e=0)),e;)try{if(a=1,i&&(t=s[0]&2?i.return:s[0]?i.throw||((t=i.return)&&t.call(i),0):i.next)&&!(t=t.call(i,s[1])).done)return t;switch(i=0,t&&(s=[s[0]&2,t.value]),s[0]){case 0:case 1:t=s;break;case 4:return e.label++,{value:s[1],done:!1};case 5:e.label++,i=s[1],s=[0];continue;case 7:s=e.ops.pop(),e.trys.pop();continue;default:if(t=e.trys,!(t=t.length>0&&t[t.length-1])&&(s[0]===6||s[0]===2)){e=0;continue}if(s[0]===3&&(!t||s[1]>t[0]&&s[1]<t[3])){e.label=s[1];break}if(s[0]===6&&e.label<t[1]){e.label=t[1],t=s;break}if(t&&e.label<t[2]){e.label=t[2],e.ops.push(s);break}t[2]&&e.ops.pop(),e.trys.pop();continue}s=n.call(r,e)}catch(l){s=[6,l],i=0}finally{a=t=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}},Dt=function(r){return Fs(void 0,void 0,void 0,function(){var n,e,a;return Gs(this,function(i){switch(i.label){case 0:return n=new Er,typeof r!="string"?[3,1]:(n.update(r),[3,3]);case 1:return[4,Vs(r)];case 2:e=i.sent(),n.update(e),i.label=3;case 3:return[4,n.digest()];case 4:return a=i.sent(),[2,pt(a)]}})})},Vs=function(r){return new Promise(function(n,e){var a=new FileReader;a.onloadend=function(){a.result&&n(a.result),a.onabort=function(){return e(new Error("Read aborted"))},a.onerror=function(){return e(a.error)}},r!==void 0&&a.readAsArrayBuffer(r)})},V=globalThis&&globalThis.__assign||function(){return V=Object.assign||function(r){for(var n,e=1,a=arguments.length;e<a;e++){n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=n[i])}return r},V.apply(this,arguments)},de=globalThis&&globalThis.__awaiter||function(r,n,e,a){function i(t){return t instanceof e?t:new e(function(o){o(t)})}return new(e||(e=Promise))(function(t,o){function u(l){try{s(a.next(l))}catch(f){o(f)}}function c(l){try{s(a.throw(l))}catch(f){o(f)}}function s(l){l.done?t(l.value):i(l.value).then(u,c)}s((a=a.apply(r,n||[])).next())})},he=globalThis&&globalThis.__generator||function(r,n){var e={label:0,sent:function(){if(t[0]&1)throw t[1];return t[1]},trys:[],ops:[]},a,i,t,o;return o={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function u(s){return function(l){return c([s,l])}}function c(s){if(a)throw new TypeError("Generator is already executing.");for(;o&&(o=0,s[0]&&(e=0)),e;)try{if(a=1,i&&(t=s[0]&2?i.return:s[0]?i.throw||((t=i.return)&&t.call(i),0):i.next)&&!(t=t.call(i,s[1])).done)return t;switch(i=0,t&&(s=[s[0]&2,t.value]),s[0]){case 0:case 1:t=s;break;case 4:return e.label++,{value:s[1],done:!1};case 5:e.label++,i=s[1],s=[0];continue;case 7:s=e.ops.pop(),e.trys.pop();continue;default:if(t=e.trys,!(t=t.length>0&&t[t.length-1])&&(s[0]===6||s[0]===2)){e=0;continue}if(s[0]===3&&(!t||s[1]>t[0]&&s[1]<t[3])){e.label=s[1];break}if(s[0]===6&&e.label<t[1]){e.label=t[1],t=s;break}if(t&&e.label<t[2]){e.label=t[2],e.ops.push(s);break}t[2]&&e.ops.pop(),e.trys.pop();continue}s=n.call(r,e)}catch(l){s=[6,l],i=0}finally{a=t=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}},Te=new _e("AWSS3ProviderManagedUpload"),Ds=function(){function r(n,e,a){this.opts=null,this.completedParts=[],this.partSize=Ye,this.bytesUploaded=0,this.totalBytesToUpload=0,this.emitter=null,this.params=n,this.opts=V({isObjectLockEnabled:!1},e),this.emitter=a,this.s3Config=ye(V(V({},e),{emitter:a,storageAction:ve.Put}))}return r.prototype.upload=function(){return de(this,void 0,void 0,function(){var n,e,a,i,t,o,u,c,s,l,f,h=this;return he(this,function(d){switch(d.label){case 0:return d.trys.push([0,12,,14]),n=this.opts.isObjectLockEnabled,n!==!0?[3,2]:(e=this.params,[4,Dt(this.params.Body)]);case 1:e.ContentMD5=d.sent(),d.label=2;case 2:return this.body=this.validateAndSanitizeBody(this.params.Body),this.totalBytesToUpload=this.byteLength(this.body),this.totalBytesToUpload<=Ye?(this.params.Body=this.body,a=Za,i=[this.s3Config],t=[V({},this.params)],f={},[4,this.getObjectKeyWithPrefix(this.params.Key)]):[3,4];case 3:return[2,a.apply(void 0,i.concat([V.apply(void 0,t.concat([(f.Key=d.sent(),f)]))]))];case 4:return this.partSize=qr(this.totalBytesToUpload),o=this,[4,this.createMultiPartUpload()];case 5:o.uploadId=d.sent(),u=Math.ceil(this.totalBytesToUpload/this.partSize),c=this.createParts(),s=0,d.label=6;case 6:return s<u?[4,this.uploadParts(this.uploadId,c.slice(s,s+bt))]:[3,9];case 7:d.sent(),d.label=8;case 8:return s+=bt,[3,6];case 9:return c.map(function(g){h.removeEventListener(g)}),[4,this.finishMultiPartUpload(this.uploadId)];case 10:return[2,d.sent()];case 11:return[3,14];case 12:return l=d.sent(),[4,this.cleanup(this.uploadId)];case 13:throw d.sent(),Te.error("Error. Cancelling the multipart upload."),l;case 14:return[2]}})})},r.prototype.createParts=function(){try{for(var n=[],e=0;e<this.totalBytesToUpload;){var a=Math.min(e+this.partSize,this.totalBytesToUpload);n.push({bodyPart:this.body.slice(e,a),partNumber:n.length+1,emitter:new mt.EventEmitter,_lastUploadedBytes:0}),e+=this.partSize}return n}catch(i){throw Te.error(i),i}},r.prototype.createMultiPartUpload=function(){return de(this,void 0,void 0,function(){var n,e,a,i,t,o;return he(this,function(u){switch(u.label){case 0:return u.trys.push([0,3,,4]),e=Or,a=[this.s3Config],i=[V({},this.params)],o={},[4,this.getObjectKeyWithPrefix(this.params.Key)];case 1:return[4,e.apply(void 0,a.concat([V.apply(void 0,i.concat([(o.Key=u.sent(),o)]))]))];case 2:return n=u.sent(),Te.debug(n.UploadId),[2,n.UploadId];case 3:throw t=u.sent(),Te.error(t),t;case 4:return[2]}})})},r.prototype.uploadParts=function(n,e){return de(this,void 0,void 0,function(){var a,i,t,o=this;return he(this,function(u){switch(u.label){case 0:return u.trys.push([0,2,,3]),[4,Promise.all(e.map(function(c){return de(o,void 0,void 0,function(){var s,l,f,h,d,g,p,v,m,y,S,E;return he(this,function(x){switch(x.label){case 0:return this.setupEventListener(c),s=this.opts.isObjectLockEnabled,s?(l=this.params,[4,Dt(c.bodyPart)]):[3,2];case 1:l.ContentMD5=x.sent(),x.label=2;case 2:return f=this.params,f.Key,h=f.Bucket,d=f.SSECustomerAlgorithm,g=f.SSECustomerKey,p=f.SSECustomerKeyMD5,v=f.ContentMD5,y=Ur,S=[V(V({},this.s3Config),{emitter:c.emitter})],E={PartNumber:c.partNumber,Body:c.bodyPart,UploadId:n},[4,this.getObjectKeyWithPrefix(this.params.Key)];case 3:return[4,y.apply(void 0,S.concat([(E.Key=x.sent(),E.Bucket=h,E.SSECustomerAlgorithm=d,E.SSECustomerKey=g,E.SSECustomerKeyMD5=p,E.ContentMD5=v,E)]))];case 4:return m=x.sent(),[2,m]}})})}))];case 1:for(a=u.sent(),i=0;i<a.length;i++)this.completedParts.push({PartNumber:e[i].partNumber,ETag:a[i].ETag});return[3,3];case 2:throw t=u.sent(),Te.error("Error happened while uploading a part. Cancelling the multipart upload"),t;case 3:return[2]}})})},r.prototype.finishMultiPartUpload=function(n){return de(this,void 0,void 0,function(){var e,a,i,t;return he(this,function(o){switch(o.label){case 0:return t={Bucket:this.params.Bucket},[4,this.getObjectKeyWithPrefix(this.params.Key)];case 1:e=(t.Key=o.sent(),t.UploadId=n,t.MultipartUpload={Parts:this.completedParts},t),o.label=2;case 2:return o.trys.push([2,4,,5]),[4,Ir(this.s3Config,e)];case 3:return a=o.sent().Key,[2,a];case 4:throw i=o.sent(),Te.error("Error happened while finishing the upload."),i;case 5:return[2]}})})},r.prototype.cleanup=function(n){return de(this,void 0,void 0,function(){var e,a,i;return he(this,function(t){switch(t.label){case 0:return this.body=null,this.completedParts=[],this.bytesUploaded=0,this.totalBytesToUpload=0,n?(i={Bucket:this.params.Bucket},[4,this.getObjectKeyWithPrefix(this.params.Key)]):[2];case 1:return e=(i.Key=t.sent(),i.UploadId=n,i),[4,jr(this.s3Config,e)];case 2:return t.sent(),[4,Kr(this.s3Config,e)];case 3:if(a=t.sent(),a&&a.Parts&&a.Parts.length>0)throw new Error("Multipart upload clean up failed.");return[2]}})})},r.prototype.removeEventListener=function(n){n.emitter.removeAllListeners(Ve),n.emitter.removeAllListeners(ct)},r.prototype.setupEventListener=function(n){var e=this;n.emitter.on(Ve,function(a){e.progressChanged(n.partNumber,a.loaded-n._lastUploadedBytes),n._lastUploadedBytes=a.loaded})},r.prototype.progressChanged=function(n,e){this.bytesUploaded+=e,this.emitter.emit(Ve,{loaded:this.bytesUploaded,total:this.totalBytesToUpload,part:n,key:this.params.Key})},r.prototype.byteLength=function(n){if(n==null)return 0;if(typeof n.byteLength=="number")return n.byteLength;if(typeof n.length=="number")return n.length;if(typeof n.size=="number")return n.size;if(typeof n.path!="string")throw new Error("Cannot determine length of "+n)},r.prototype.validateAndSanitizeBody=function(n){var e=this.isGenericObject(n)?JSON.stringify(n):n;if(this.byteLength(e)>Hr)throw new Error("File size bigger than S3 Object limit of 5TB, got ".concat(this.totalBytesToUpload," Bytes"));return e},r.prototype.isGenericObject=function(n){if(n!==null&&typeof n=="object")try{return!(this.byteLength(n)>=0)}catch{return!0}return!1},r.prototype.getObjectKeyWithPrefix=function(n){return de(this,void 0,void 0,function(){var e,a,i;return he(this,function(t){switch(t.label){case 0:return e=Gr,a=[V({},this.opts)],i={},[4,Vr()];case 1:return[4,e.apply(void 0,[V.apply(void 0,a.concat([(i.credentials=t.sent(),i)]))])];case 2:return[2,t.sent()+n]}})})},r}(),ue=globalThis&&globalThis.__assign||function(){return ue=Object.assign||function(r){for(var n,e=1,a=arguments.length;e<a;e++){n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=n[i])}return r},ue.apply(this,arguments)},F=globalThis&&globalThis.__awaiter||function(r,n,e,a){function i(t){return t instanceof e?t:new e(function(o){o(t)})}return new(e||(e=Promise))(function(t,o){function u(l){try{s(a.next(l))}catch(f){o(f)}}function c(l){try{s(a.throw(l))}catch(f){o(f)}}function s(l){l.done?t(l.value):i(l.value).then(u,c)}s((a=a.apply(r,n||[])).next())})},G=globalThis&&globalThis.__generator||function(r,n){var e={label:0,sent:function(){if(t[0]&1)throw t[1];return t[1]},trys:[],ops:[]},a,i,t,o;return o={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function u(s){return function(l){return c([s,l])}}function c(s){if(a)throw new TypeError("Generator is already executing.");for(;o&&(o=0,s[0]&&(e=0)),e;)try{if(a=1,i&&(t=s[0]&2?i.return:s[0]?i.throw||((t=i.return)&&t.call(i),0):i.next)&&!(t=t.call(i,s[1])).done)return t;switch(i=0,t&&(s=[s[0]&2,t.value]),s[0]){case 0:case 1:t=s;break;case 4:return e.label++,{value:s[1],done:!1};case 5:e.label++,i=s[1],s=[0];continue;case 7:s=e.ops.pop(),e.trys.pop();continue;default:if(t=e.trys,!(t=t.length>0&&t[t.length-1])&&(s[0]===6||s[0]===2)){e=0;continue}if(s[0]===3&&(!t||s[1]>t[0]&&s[1]<t[3])){e.label=s[1];break}if(s[0]===6&&e.label<t[1]){e.label=t[1],t=s;break}if(t&&e.label<t[2]){e.label=t[2],e.ops.push(s);break}t[2]&&e.ops.pop(),e.trys.pop();continue}s=n.call(r,e)}catch(l){s=[6,l],i=0}finally{a=t=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}},Ht=globalThis&&globalThis.__read||function(r,n){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var a=e.call(r),i,t=[],o;try{for(;(n===void 0||n-- >0)&&!(i=a.next()).done;)t.push(i.value)}catch(u){o={error:u}}finally{try{i&&!i.done&&(e=a.return)&&e.call(a)}finally{if(o)throw o.error}}return t},qt=globalThis&&globalThis.__spreadArray||function(r,n,e){if(e||arguments.length===2)for(var a=0,i=n.length,t;a<i;a++)(t||!(a in n))&&(t||(t=Array.prototype.slice.call(n,0,a)),t[a]=n[a]);return r.concat(t||Array.prototype.slice.call(n))},R=new _e("AWSS3UploadTask"),C;(function(r){r[r.INIT=0]="INIT",r[r.IN_PROGRESS=1]="IN_PROGRESS",r[r.PAUSED=2]="PAUSED",r[r.CANCELLED=3]="CANCELLED",r[r.COMPLETED=4]="COMPLETED"})(C||(C={}));var q;(function(r){r.CANCEL="cancel",r.UPLOAD_COMPLETE="uploadComplete",r.UPLOAD_PROGRESS="uploadPartProgress",r.ERROR="error"})(q||(q={}));function Hs(r,n){return r.PartNumber-n.PartNumber}var rn=function(){function r(n){var e=n.s3Config,a=n.file,i=n.emitter,t=n.storage,o=n.params,u=n.level,c=n.prefixPromise;this.queueSize=bt,this.partSize=Ye,this.inProgress=[],this.completedParts=[],this.queued=[],this.bytesUploaded=0,this.totalBytes=0,this.state=C.INIT,this.prefixPromise=c,this.s3Config=e,this.storage=t,this.storageSync=Promise.resolve(),typeof this.storage.sync=="function"&&(this.storageSync=this.storage.sync()),this.params=o,this.file=a,this.totalBytes=this.file.size,this.bytesUploaded=0,this.emitter=i,this.queued=[],this.fileId=this._getFileId(u),this._validateParams(),this.emitter.on(q.ERROR,function(){})}return Object.defineProperty(r.prototype,"percent",{get:function(){return this.bytesUploaded/this.totalBytes*100},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"isInProgress",{get:function(){return this.state===C.IN_PROGRESS},enumerable:!1,configurable:!0}),r.prototype._listSingleFile=function(n){var e=n.key,a=n.bucket;return F(this,void 0,void 0,function(){var i,t,o,u;return G(this,function(c){switch(c.label){case 0:return[4,this.prefixPromise];case 1:return i=c.sent(),[4,Tr(this.s3Config,{Bucket:a,Prefix:i+e})];case 2:return t=c.sent().Contents,o=t===void 0?[]:t,u=o.find(function(s){return s.Key==="".concat(i).concat(e)}),[2,u]}})})},r.prototype._getFileId=function(n){return Ps(this.file)?[this.file.name,this.file.lastModified,this.file.size,this.file.type,this.params.Bucket,n,this.params.Key].join("-"):[this.file.size,this.file.type,this.params.Bucket,n,this.params.Key].join("-")},r.prototype._findCachedUploadParts=function(){return F(this,void 0,void 0,function(){var n,e,a,i,t,o,u;return G(this,function(c){switch(c.label){case 0:return[4,this._listCachedUploadTasks()];case 1:return n=c.sent(),Object.keys(n).length===0||!Object.prototype.hasOwnProperty.call(n,this.fileId)?[2,{parts:[],uploadId:null}]:(e=n[this.fileId],e.lastTouched=Date.now(),this.storage.setItem(Ie,JSON.stringify(n)),t=Kr,o=[this.s3Config],u={Bucket:this.params.Bucket},[4,this.prefixPromise]);case 2:return[4,t.apply(void 0,o.concat([(u.Key=c.sent()+this.params.Key,u.UploadId=e.uploadId,u)]))];case 3:return a=c.sent().Parts,i=a===void 0?[]:a,[2,{parts:i,uploadId:e.uploadId}]}})})},r.prototype._emitEvent=function(n,e){this.emitter.emit(n,e)},r.prototype._validateParams=function(){if(this.totalBytes>Hr)throw new Error("File size bigger than S3 Object limit of 5TB, got ".concat(this.totalBytes," Bytes"))},r.prototype._listCachedUploadTasks=function(){return F(this,void 0,void 0,function(){var n;return G(this,function(e){switch(e.label){case 0:return[4,this.storageSync];case 1:return e.sent(),n=this.storage.getItem(Ie)||"{}",[2,JSON.parse(n)]}})})},r.prototype._cache=function(n){return F(this,void 0,void 0,function(){var e;return G(this,function(a){switch(a.label){case 0:return[4,this._listCachedUploadTasks()];case 1:return e=a.sent(),e[this.fileId]=n,this.storage.setItem(Ie,JSON.stringify(e)),[2]}})})},r.prototype._isCached=function(){return F(this,void 0,void 0,function(){var n,e;return G(this,function(a){switch(a.label){case 0:return e=(n=Object.prototype.hasOwnProperty).call,[4,this._listCachedUploadTasks()];case 1:return[2,e.apply(n,[a.sent(),this.fileId])]}})})},r.prototype._removeFromCache=function(){return F(this,void 0,void 0,function(){var n;return G(this,function(e){switch(e.label){case 0:return[4,this._listCachedUploadTasks()];case 1:return n=e.sent(),delete n[this.fileId],this.storage.setItem(Ie,JSON.stringify(n)),[2]}})})},r.prototype._onPartUploadCompletion=function(n){var e=n.eTag,a=n.partNumber,i=n.chunk;return F(this,void 0,void 0,function(){return G(this,function(t){return this.completedParts.push({ETag:e,PartNumber:a}),this.bytesUploaded+=Ns(i),this._emitEvent(q.UPLOAD_PROGRESS,{loaded:this.bytesUploaded,total:this.totalBytes}),this.inProgress=this.inProgress.filter(function(o){return o.uploadPartInput.PartNumber!==a}),this.queued.length&&this.state!==C.PAUSED&&this._startNextPart(),this._isDone()&&this._completeUpload(),[2]})})},r.prototype._completeUpload=function(){return F(this,void 0,void 0,function(){var n,e,a,i;return G(this,function(t){switch(t.label){case 0:return t.trys.push([0,4,,5]),n=Ir,e=[this.s3Config],i={Bucket:this.params.Bucket},[4,this.prefixPromise];case 1:return[4,n.apply(void 0,e.concat([(i.Key=t.sent()+this.params.Key,i.UploadId=this.uploadId,i.MultipartUpload={Parts:qt([],Ht(this.completedParts),!1).sort(Hs)},i)]))];case 2:return t.sent(),[4,this._verifyFileSize()];case 3:return t.sent(),this._emitEvent(q.UPLOAD_COMPLETE,{key:this.params.Key}),this._removeFromCache(),this.state=C.COMPLETED,[3,5];case 4:return a=t.sent(),R.error("error completing upload",a),this._emitEvent(q.ERROR,a),[3,5];case 5:return[2]}})})},r.prototype._makeUploadPartRequest=function(n,e){return F(this,void 0,void 0,function(){var a,i,t,o,u,c;return G(this,function(s){switch(s.label){case 0:return s.trys.push([0,4,,5]),i=Ur,t=[ue(ue({},this.s3Config),{abortSignal:e})],o=[ue({},n)],c={},[4,this.prefixPromise];case 1:return[4,i.apply(void 0,t.concat([ue.apply(void 0,o.concat([(c.Key=s.sent()+this.params.Key,c)]))]))];case 2:return a=s.sent(),[4,this._onPartUploadCompletion({eTag:a.ETag,partNumber:n.PartNumber,chunk:n.Body})];case 3:return s.sent(),[3,5];case 4:return u=s.sent(),this.state===C.PAUSED?R.log("upload paused"):this.state===C.CANCELLED?R.log("upload aborted"):R.error("error starting next part of upload: ",u),!gt(u)&&u.message!==ti&&(this._emitEvent(q.ERROR,u),this.pause()),[3,5];case 5:return[2]}})})},r.prototype._startNextPart=function(){if(this.queued.length>0&&this.state!==C.PAUSED){var n=new AbortController,e=this.queued.shift();this.inProgress.push({uploadPartInput:e,s3Request:this._makeUploadPartRequest(e,n.signal),abortController:n})}},r.prototype._verifyFileSize=function(){return F(this,void 0,void 0,function(){var n,e,a;return G(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,this._listSingleFile({key:this.params.Key,bucket:this.params.Bucket})];case 1:return e=i.sent(),n=!!(e&&e.Size===this.file.size),[3,3];case 2:return a=i.sent(),R.log("Could not get file on s3 for size matching: ",a),[2];case 3:if(!n)throw new Error("File size does not match between local file and file on s3");return[2]}})})},r.prototype._isDone=function(){return!this.queued.length&&!this.inProgress.length&&this.bytesUploaded===this.totalBytes},r.prototype._createParts=function(){for(var n=this.file.size,e=[],a=0;a<n;){var i=Math.min(a+this.partSize,n);e.push({Body:this.file.slice(a,i),Key:this.params.Key,Bucket:this.params.Bucket,PartNumber:e.length+1,UploadId:this.uploadId}),a+=this.partSize}return e},r.prototype._initCachedUploadParts=function(n){this.bytesUploaded+=n.reduce(function(a,i){return a+i.Size},0);var e=new Set(n.map(function(a){return a.PartNumber}));this.queued=this.queued.filter(function(a){return!e.has(a.PartNumber)}),this.completedParts=n.map(function(a){return{PartNumber:a.PartNumber,ETag:a.ETag}}),this._emitEvent(q.UPLOAD_PROGRESS,{loaded:this.bytesUploaded,total:this.totalBytes})},r.prototype._initMultipartUpload=function(){return F(this,void 0,void 0,function(){var n,e,a,i,t;return G(this,function(o){switch(o.label){case 0:return e=Or,a=[this.s3Config],i=[ue({},this.params)],t={},[4,this.prefixPromise];case 1:return[4,e.apply(void 0,a.concat([ue.apply(void 0,i.concat([(t.Key=o.sent()+this.params.Key,t)]))]))];case 2:return n=o.sent(),this._cache({uploadId:n.UploadId,lastTouched:Date.now(),bucket:this.params.Bucket,key:this.params.Key,fileName:this.file instanceof File?this.file.name:""}),[2,n.UploadId]}})})},r.prototype._initializeUploadTask=function(){return F(this,void 0,void 0,function(){var n,e,a,a,i;return G(this,function(t){switch(t.label){case 0:this.state=C.IN_PROGRESS,this.partSize=qr(this.totalBytes),t.label=1;case 1:return t.trys.push([1,7,,8]),[4,this._isCached()];case 2:return t.sent()?[4,this._findCachedUploadParts()]:[3,4];case 3:return n=t.sent(),e=n.parts,a=n.uploadId,this.uploadId=a,this.queued=this._createParts(),this._initCachedUploadParts(e),this._isDone()?this._completeUpload():this._startUpload(),[3,6];case 4:return this.uploadId?[3,6]:[4,this._initMultipartUpload()];case 5:a=t.sent(),this.uploadId=a,this.queued=this._createParts(),this._startUpload(),t.label=6;case 6:return[3,8];case 7:return i=t.sent(),gt(i)||(R.error("Error initializing the upload task",i),this._emitEvent(q.ERROR,i)),[3,8];case 8:return[2]}})})},r.prototype.resume=function(){this.state===C.CANCELLED?R.warn("This task has already been cancelled"):this.state===C.COMPLETED?R.warn("This task has already been completed"):this.state===C.IN_PROGRESS?R.warn("Upload task already in progress"):this.uploadId?this._startUpload():this._initializeUploadTask()},r.prototype._startUpload=function(){this.state=C.IN_PROGRESS;for(var n=0;n<this.queueSize;n++)this._startNextPart()},r.prototype._cancel=function(){return F(this,void 0,void 0,function(){var n,e,a,i;return G(this,function(t){switch(t.label){case 0:return this.state!==C.CANCELLED?[3,1]:(R.warn("This task has already been cancelled"),[2,!1]);case 1:return this.state!==C.COMPLETED?[3,2]:(R.warn("This task has already been completed"),[2,!1]);case 2:this.pause(),this.queued=[],this.completedParts=[],this.bytesUploaded=0,this.state=C.CANCELLED,t.label=3;case 3:return t.trys.push([3,7,,8]),n=jr,e=[this.s3Config],i={Bucket:this.params.Bucket},[4,this.prefixPromise];case 4:return[4,n.apply(void 0,e.concat([(i.Key=t.sent()+this.params.Key,i.UploadId=this.uploadId,i)]))];case 5:return t.sent(),[4,this._removeFromCache()];case 6:return t.sent(),[2,!0];case 7:return a=t.sent(),R.error("Error cancelling upload task",a),[2,!1];case 8:return[2]}})})},r.prototype.pause=function(){var n;this.state===C.CANCELLED?R.warn("This task has already been cancelled"):this.state===C.COMPLETED?R.warn("This task has already been completed"):this.state===C.PAUSED&&R.warn("This task is already paused"),this.state=C.PAUSED;var e=this.inProgress.splice(0,this.inProgress.length);e.forEach(function(a){a.abortController.abort()}),(n=this.queued).unshift.apply(n,qt([],Ht(e.map(function(a){return a.uploadPartInput})),!1))},r}(),_=globalThis&&globalThis.__assign||function(){return _=Object.assign||function(r){for(var n,e=1,a=arguments.length;e<a;e++){n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=n[i])}return r},_.apply(this,arguments)},ge=globalThis&&globalThis.__awaiter||function(r,n,e,a){function i(t){return t instanceof e?t:new e(function(o){o(t)})}return new(e||(e=Promise))(function(t,o){function u(l){try{s(a.next(l))}catch(f){o(f)}}function c(l){try{s(a.throw(l))}catch(f){o(f)}}function s(l){l.done?t(l.value):i(l.value).then(u,c)}s((a=a.apply(r,n||[])).next())})},pe=globalThis&&globalThis.__generator||function(r,n){var e={label:0,sent:function(){if(t[0]&1)throw t[1];return t[1]},trys:[],ops:[]},a,i,t,o;return o={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function u(s){return function(l){return c([s,l])}}function c(s){if(a)throw new TypeError("Generator is already executing.");for(;o&&(o=0,s[0]&&(e=0)),e;)try{if(a=1,i&&(t=s[0]&2?i.return:s[0]?i.throw||((t=i.return)&&t.call(i),0):i.next)&&!(t=t.call(i,s[1])).done)return t;switch(i=0,t&&(s=[s[0]&2,t.value]),s[0]){case 0:case 1:t=s;break;case 4:return e.label++,{value:s[1],done:!1};case 5:e.label++,i=s[1],s=[0];continue;case 7:s=e.ops.pop(),e.trys.pop();continue;default:if(t=e.trys,!(t=t.length>0&&t[t.length-1])&&(s[0]===6||s[0]===2)){e=0;continue}if(s[0]===3&&(!t||s[1]>t[0]&&s[1]<t[3])){e.label=s[1];break}if(s[0]===6&&e.label<t[1]){e.label=t[1],t=s;break}if(t&&e.label<t[2]){e.label=t[2],e.ops.push(s);break}t[2]&&e.ops.pop(),e.trys.pop();continue}s=n.call(r,e)}catch(l){s=[6,l],i=0}finally{a=t=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}},Xt=globalThis&&globalThis.__read||function(r,n){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var a=e.call(r),i,t=[],o;try{for(;(n===void 0||n-- >0)&&!(i=a.next()).done;)t.push(i.value)}catch(u){o={error:u}}finally{try{i&&!i.done&&(e=a.return)&&e.call(a)}finally{if(o)throw o.error}}return t},Wt=globalThis&&globalThis.__spreadArray||function(r,n,e){if(e||arguments.length===2)for(var a=0,i=n.length,t;a<i;a++)(t||!(a in n))&&(t||(t=Array.prototype.slice.call(n,0,a)),t[a]=n[a]);return r.concat(t||Array.prototype.slice.call(n))},T=new _e("AWSS3Provider"),Yt="public",qs=900,Xs=function(){function r(n){var e=this;this._config=n||{},this._storage=new vn().getStorage(),er.listen("auth",function(a){var i=a.payload;(i.event==="signOut"||i.event==="signIn")&&e._storage.removeItem(Ie)}),T.debug("Storage Options",this._config)}return r.prototype.getCategory=function(){return r.CATEGORY},r.prototype.getProviderName=function(){return r.PROVIDER_NAME},r.prototype.configure=function(n){if(T.debug("configure Storage",n),!n)return this._config;var e=tr(n);return this._config=Object.assign({},this._config,e.Storage),this._config.bucket||T.debug("Do not have bucket yet"),this._config},r.prototype.startResumableUpload=function(n,e){var a,i=n.s3Config,t=n.emitter,o=n.key,u=n.file,c=n.params,s=e.progressCallback,l=e.completeCallback,f=e.errorCallback,h=(a=e.track,a===void 0?!1:a);if(!(u instanceof Blob))throw new Error(J.INVALID_BLOB);t.on(q.UPLOAD_PROGRESS,function(p){s&&(typeof s=="function"?s(p):T.warn("progressCallback should be a function, not a "+typeof s))}),t.on(q.UPLOAD_COMPLETE,function(p){l&&(typeof l=="function"?l(p):T.warn("completeCallback should be a function, not a "+typeof l))}),t.on(q.ERROR,function(p){f&&(typeof f=="function"?f(p):T.warn("errorCallback should be a function, not a "+typeof f))});var d=Ce.get().then(function(p){var v=Ce.shear(p);return Gr(_(_({},e),{level:n.accessLevel,credentials:v}))}),g=new rn({s3Config:i,file:u,emitter:t,level:n.accessLevel,storage:this._storage,params:c,prefixPromise:d});return I(h,"upload",{method:"put",result:"success"},null,"Upload Task created successfully for ".concat(o)),g.resume(),g},r.prototype.copy=function(n,e,a){return ge(this,void 0,void 0,function(){var i,t,o,u,c,s,l,f,h,d,g,p,v,m,y,S,E,x,H,M,b,P,se,re,ne;return pe(this,function(O){switch(O.label){case 0:return[4,this._ensureCredentials()];case 1:if(i=O.sent(),!i||!this._isWithCredentials(this._config))throw new Error(J.NO_CREDENTIALS);if(t=Object.assign({},this._config,a),o=t.acl,u=t.bucket,c=t.cacheControl,s=t.expires,l=t.track,f=t.serverSideEncryption,h=t.SSECustomerAlgorithm,d=t.SSECustomerKey,g=t.SSECustomerKeyMD5,p=t.SSEKMSKeyId,v=(re=n.level,re===void 0?Yt:re),m=n.identityId,y=n.key,S=(ne=e.level,ne===void 0?Yt:ne),E=e.key,!y||typeof y!="string")throw new Error(J.NO_SRC_KEY);if(!E||typeof E!="string")throw new Error(J.NO_DEST_KEY);v!=="protected"&&m&&T.warn(`You may copy files from another user if the source level is "protected", currently it's `.concat(v)),x=this._prefix(_(_(_({},t),{level:v}),m&&{identityId:m})),H=this._prefix(_(_({},t),{level:S})),M="".concat(u,"/").concat(x).concat(y),b="".concat(H).concat(E),T.debug("copying ".concat(M," to ").concat(b)),P={Bucket:u,CopySource:M,Key:b,MetadataDirective:"COPY"},c&&(P.CacheControl=c),s&&(P.Expires=s),f&&(P.ServerSideEncryption=f),h&&(P.SSECustomerAlgorithm=h),d&&(P.SSECustomerKey=d),g&&(P.SSECustomerKeyMD5=g),p&&(P.SSEKMSKeyId=p),o&&(P.ACL=o),O.label=2;case 2:return O.trys.push([2,4,,5]),[4,ys(ye(_(_({},t),{storageAction:ve.Copy})),P)];case 3:return O.sent(),I(l,"copy",{method:"copy",result:"success"},null,"Copy success from ".concat(y," to ").concat(E)),[2,{key:E}];case 4:throw se=O.sent(),I(l,"copy",{method:"copy",result:"failed"},null,"Copy failed from ".concat(y," to ").concat(E)),se;case 5:return[2]}})})},r.prototype.get=function(n,e){var a;return ge(this,void 0,void 0,function(){var i,t,o,u,c,s,l,f,h,d,g,p,v,m,y,S,E,x,H,M,b,P,se,re,ne,O,Ot,rt,nt,Ae;return pe(this,function(K){switch(K.label){case 0:return[4,this._ensureCredentials()];case 1:if(i=K.sent(),!i||!this._isWithCredentials(this._config))throw new Error(J.NO_CREDENTIALS);if(t=Object.assign({},this._config,e),o=t.bucket,u=t.download,c=t.cacheControl,s=t.contentDisposition,l=t.contentEncoding,f=t.contentLanguage,h=t.contentType,d=t.expires,g=t.track,p=t.SSECustomerAlgorithm,v=t.SSECustomerKey,m=t.SSECustomerKeyMD5,y=t.progressCallback,S=(nt=t.validateObjectExistence,nt===void 0?!1:nt),E=this._prefix(t),x=E+n,H=new mt.EventEmitter,M=ye(_(_({},t),{emitter:H,storageAction:ve.Get})),T.debug("get "+n+" from "+x),b={Bucket:o,Key:x},c&&(b.ResponseCacheControl=c),s&&(b.ResponseContentDisposition=s),l&&(b.ResponseContentEncoding=l),f&&(b.ResponseContentLanguage=f),h&&(b.ResponseContentType=h),p&&(b.SSECustomerAlgorithm=p),v&&(b.SSECustomerKey=v),m&&(b.SSECustomerKeyMD5=m),u!==!0)return[3,5];K.label=2;case 2:return K.trys.push([2,4,,5]),y&&(typeof y=="function"?H.on(ct,function(nn){y(nn)}):T.warn("progressCallback should be a function, not a "+typeof y)),[4,Ka(M,b)];case 3:return P=K.sent(),H.removeAllListeners(ct),I(g,"download",{method:"get",result:"success"},{fileSize:Number(P.Body.size||P.Body.length)},"Download success for ".concat(n)),[2,P];case 4:throw se=K.sent(),I(g,"download",{method:"get",result:"failed"},null,"Download failed with ".concat(se.message)),se;case 5:if(!S)return[3,9];K.label=6;case 6:return K.trys.push([6,8,,9]),[4,jt(M,b)];case 7:return K.sent(),[3,9];case 8:throw re=K.sent(),((a=re.$metadata)===null||a===void 0?void 0:a.httpStatusCode)===404&&I(g,"getSignedUrl",{method:"get",result:"failed"},null,"".concat(n," not found")),re;case 9:return K.trys.push([9,12,,13]),O=ja,Ot=[_({},M)],Ae={expiration:d||qs},[4,M.credentials()];case 10:return[4,O.apply(void 0,[_.apply(void 0,Ot.concat([(Ae.credentials=K.sent(),Ae.signingRegion=M.region,Ae.signingService=_r,Ae)])),b])];case 11:return ne=K.sent(),I(g,"getSignedUrl",{method:"get",result:"success"},null,"Signed URL: ".concat(ne)),[2,ne];case 12:throw rt=K.sent(),T.warn("get signed url error",rt),I(g,"getSignedUrl",{method:"get",result:"failed"},null,"Could not get a signed URL for ".concat(n)),rt;case 13:return[2]}})})},r.prototype.getProperties=function(n,e){var a;return ge(this,void 0,void 0,function(){var i,t,o,u,c,s,l,f,h,d,g,p,v,m,y;return pe(this,function(S){switch(S.label){case 0:return[4,this._ensureCredentials()];case 1:if(i=S.sent(),!i||!this._isWithCredentials(this._config))throw new Error(J.NO_CREDENTIALS);t=Object.assign({},this._config,e),o=t.bucket,u=(y=t.track,y===void 0?!1:y),c=t.SSECustomerAlgorithm,s=t.SSECustomerKey,l=t.SSECustomerKeyMD5,f=this._prefix(t),h=f+n,T.debug("getProperties ".concat(n," from ").concat(h)),d=ye(_(_({},t),{storageAction:ve.GetProperties})),g={Bucket:o,Key:h},c&&(g.SSECustomerAlgorithm=c),s&&(g.SSECustomerKey=s),l&&(g.SSECustomerKeyMD5=l),S.label=2;case 2:return S.trys.push([2,4,,5]),[4,jt(d,g)];case 3:return p=S.sent(),v={contentLength:p.ContentLength,contentType:p.ContentType,eTag:p.ETag,lastModified:p.LastModified,metadata:p.Metadata},I(u,"getProperties",{method:"getProperties",result:"success"},null,"getProperties successful for ".concat(n)),[2,v];case 4:throw m=S.sent(),((a=m.$metadata)===null||a===void 0?void 0:a.httpStatusCode)===404&&I(u,"getProperties",{method:"getProperties",result:"failed"},null,"".concat(n," not found")),m;case 5:return[2]}})})},r.prototype.put=function(n,e,a){var i=Object.assign({},this._config,a),t=i.bucket,o=i.track,u=i.progressCallback,c=i.level,s=i.resumable,l=i.contentType,f=i.contentDisposition,h=i.contentEncoding,d=i.cacheControl,g=i.expires,p=i.metadata,v=i.tagging,m=i.acl,y=i.serverSideEncryption,S=i.SSECustomerAlgorithm,E=i.SSECustomerKey,x=i.SSECustomerKeyMD5,H=i.SSEKMSKeyId,M=l||"binary/octet-stream",b={Bucket:t,Key:n,Body:e,ContentType:M};d&&(b.CacheControl=d),f&&(b.ContentDisposition=f),h&&(b.ContentEncoding=h),g&&(b.Expires=g),p&&(b.Metadata=p),v&&(b.Tagging=v),y&&(b.ServerSideEncryption=y),S&&(b.SSECustomerAlgorithm=S),E&&(b.SSECustomerKey=E),x&&(b.SSECustomerKeyMD5=x),H&&(b.SSEKMSKeyId=H);var P=new mt.EventEmitter,se=new Ds(b,i,P);if(m&&(b.ACL=m),s===!0){var re=ye(_(_({},i),{storageAction:ve.Put})),ne={bucket:t,key:n,s3Config:re,file:e,emitter:P,accessLevel:c,params:b};return this.startResumableUpload(ne,a)}try{return u&&(typeof u=="function"?P.on(Ve,function(O){u(O)}):T.warn("progressCallback should be a function, not a "+typeof u)),se.upload().then(function(O){return T.debug("upload result",O),I(o,"upload",{method:"put",result:"success"},null,"Upload success for ".concat(n)),{key:n}})}catch(O){throw T.warn("error uploading",O),I(o,"upload",{method:"put",result:"failed"},null,"Error uploading ".concat(n)),O}},r.prototype.remove=function(n,e){return ge(this,void 0,void 0,function(){var a,i,t,o,u,c,s,l,f,h;return pe(this,function(d){switch(d.label){case 0:return[4,this._ensureCredentials()];case 1:if(a=d.sent(),!a||!this._isWithCredentials(this._config))throw new Error(J.NO_CREDENTIALS);i=Object.assign({},this._config,e),t=i.bucket,o=i.track,u=this._prefix(i),c=u+n,T.debug("remove "+n+" from "+c),s={Bucket:t,Key:c},l=ye(_(_({},i),{storageAction:ve.Remove})),d.label=2;case 2:return d.trys.push([2,4,,5]),[4,Ts(l,s)];case 3:return f=d.sent(),I(o,"delete",{method:"remove",result:"success"},null,"Deleted ".concat(n," successfully")),[2,f];case 4:throw h=d.sent(),I(o,"delete",{method:"remove",result:"failed"},null,"Deletion of ".concat(n," failed with ").concat(h)),h;case 5:return[2]}})})},r.prototype._list=function(n,e,a){return ge(this,void 0,void 0,function(){var i,t;return pe(this,function(o){switch(o.label){case 0:return i={results:[],hasNextToken:!1},[4,Tr(ye(_(_({},e),{storageAction:ve.List})),_({},n))];case 1:return t=o.sent(),t&&t.Contents&&(i.results=t.Contents.map(function(u){return{key:u.Key.substr(a.length),eTag:u.ETag,lastModified:u.LastModified,size:u.Size}}),i.nextToken=t.NextContinuationToken,i.hasNextToken=t.IsTruncated),[2,i]}})})},r.prototype.list=function(n,e){return ge(this,void 0,void 0,function(){var a,i,t,o,u,c,s,l,f,h,d,g,p,v,m;return pe(this,function(y){switch(y.label){case 0:return[4,this._ensureCredentials()];case 1:if(a=y.sent(),!a||!this._isWithCredentials(this._config))throw new Error(J.NO_CREDENTIALS);i=Object.assign({},this._config,e),t=i.bucket,o=i.track,u=i.pageSize,c=i.nextToken,s=this._prefix(i),l=s+n,T.debug("list "+n+" from "+l),y.label=2;case 2:if(y.trys.push([2,10,,11]),f={results:[],hasNextToken:!1},h=1e3,d=void 0,g={Bucket:t,Prefix:l,MaxKeys:h,ContinuationToken:c},g.ContinuationToken=c,u!=="ALL")return[3,7];y.label=3;case 3:return[4,this._list(g,i,s)];case 4:d=y.sent(),(v=f.results).push.apply(v,Wt([],Xt(d.results),!1)),d.nextToken&&(g.ContinuationToken=d.nextToken),y.label=5;case 5:if(d.nextToken)return[3,3];y.label=6;case 6:return[3,9];case 7:return u&&u<=h&&typeof u=="number"?g.MaxKeys=u:T.warn("pageSize should be from 0 - ".concat(h,".")),[4,this._list(g,i,s)];case 8:d=y.sent(),(m=f.results).push.apply(m,Wt([],Xt(d.results),!1)),f.hasNextToken=d.hasNextToken,f.nextToken=d.nextToken,y.label=9;case 9:return I(o,"list",{method:"list",result:"success"},null,"".concat(f.results.length," items returned from list operation")),T.debug("list",f),[2,f];case 10:throw p=y.sent(),T.error("list InvalidArgument",p),I(o,"list",{method:"list",result:"failed"},null,"Listing items failed: ".concat(p.message)),p;case 11:return[2]}})})},r.prototype._ensureCredentials=function(){return ge(this,void 0,void 0,function(){var n,e,a;return pe(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,Ce.get()];case 1:return n=i.sent(),n?(e=Ce.shear(n),T.debug("set credentials for storage",e),this._config.credentials=e,[2,!0]):[2,!1];case 2:return a=i.sent(),T.warn("ensure credentials error",a),[2,!1];case 3:return[2]}})})},r.prototype._isWithCredentials=function(n){return typeof n=="object"&&n.hasOwnProperty("credentials")},r.prototype._prefix=function(n){var e=n.credentials,a=n.level,i=n.customPrefix||{},t=n.identityId||e.identityId,o=(i.private!==void 0?i.private:"private/")+t+"/",u=(i.protected!==void 0?i.protected:"protected/")+t+"/",c=i.public!==void 0?i.public:"public/";switch(a){case"private":return o;case"protected":return u;default:return c}},r.CATEGORY="Storage",r.PROVIDER_NAME="AWSS3",r}(),B=globalThis&&globalThis.__assign||function(){return B=Object.assign||function(r){for(var n,e=1,a=arguments.length;e<a;e++){n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=n[i])}return r},B.apply(this,arguments)},Ws=globalThis&&globalThis.__read||function(r,n){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var a=e.call(r),i,t=[],o;try{for(;(n===void 0||n-- >0)&&!(i=a.next()).done;)t.push(i.value)}catch(u){o={error:u}}finally{try{i&&!i.done&&(e=a.return)&&e.call(a)}finally{if(o)throw o.error}}return t},Z=new _e("StorageClass"),st=new _e("Storage"),ie="AWSS3",Zt=function(){function r(){this._config={},this._pluggables=[],this._abortControllerMap=new WeakMap,Z.debug("Storage Options",this._config),this.get=this.get.bind(this),this.put=this.put.bind(this),this.remove=this.remove.bind(this),this.list=this.list.bind(this)}return r.prototype.getModuleName=function(){return"Storage"},r.prototype.addPluggable=function(n){if(n&&n.getCategory()==="Storage"){this._pluggables.push(n);var e={};return e=n.configure(this._config[n.getProviderName()]),e}},r.prototype.getPluggable=function(n){var e=this._pluggables.find(function(a){return a.getProviderName()===n});return e===void 0?(Z.debug("No plugin found with providerName",n),null):e},r.prototype.removePluggable=function(n){this._pluggables=this._pluggables.filter(function(e){return e.getProviderName()!==n})},r.prototype.configure=function(n){var e=this,a;if(Z.debug("configure Storage"),!n)return this._config;var i=tr(n),t=(a=i.Storage)!==null&&a!==void 0?a:{},o=["bucket","region","level","track","customPrefix","ContentMD5","serverSideEncryption","SSECustomerAlgorithm","SSECustomerKey","SSECustomerKeyMD5","SSEKMSKeyId"],u=function(c){return Object.keys(c).find(function(s){return o.includes(s)})};return u(t)&&!t[ie]&&(t[ie]={}),Object.entries(t).forEach(function(c){var s=Ws(c,2),l=s[0],f=s[1];l&&o.includes(l)&&f!==void 0&&(t[ie][l]=f,delete t[l])}),Object.keys(t).forEach(function(c){typeof t[c]!="string"&&(e._config[c]=B(B({},e._config[c]),t[c]))}),this._pluggables.forEach(function(c){c.configure(e._config[c.getProviderName()])}),this._pluggables.length===0&&this.addPluggable(new Xs),this._config},r.prototype.getAbortController=function(){return new AbortController},r.prototype.updateRequestToBeCancellable=function(n,e){this._abortControllerMap.set(n,e)},r.prototype.isUploadTask=function(n){return typeof n<"u"&&typeof n.pause=="function"&&typeof n.resume=="function"},r.prototype.cancel=function(n,e){if(n instanceof rn)return n._cancel();var a=this._abortControllerMap.get(n);a?a.abort(e):Z.debug("The request does not map to any cancel token")},r.prototype.copy=function(n,e,a){var i=a?.provider||ie,t=this._pluggables.find(function(c){return c.getProviderName()===i});if(t===void 0)return Z.debug("No plugin found with providerName",i),Promise.reject("No plugin found in Storage for the provider");var o=this.getAbortController();if(typeof t.copy!="function")return Promise.reject(".copy is not implemented on provider ".concat(t.getProviderName()));var u=t.copy(n,e,B(B({},a),{abortSignal:o.signal}));return this.updateRequestToBeCancellable(u,o),u},r.prototype.get=function(n,e){var a=e?.provider||ie,i=this._pluggables.find(function(u){return u.getProviderName()===a});if(i===void 0)return Z.debug("No plugin found with providerName",a),Promise.reject("No plugin found in Storage for the provider");var t=this.getAbortController(),o=i.get(n,B(B({},e),{abortSignal:t.signal}));return this.updateRequestToBeCancellable(o,t),o},r.prototype.isCancelError=function(n){return gt(n)},r.prototype.getProperties=function(n,e){var a=e?.provider||ie,i=this._pluggables.find(function(u){return u.getProviderName()===a});if(i===void 0)throw Z.debug("No plugin found with providerName",a),new Error("No plugin found with providerName");var t=this.getAbortController();if(typeof i.getProperties!="function")return Promise.reject(".getProperties is not implemented on provider ".concat(i.getProviderName()));var o=i?.getProperties(n,B({},e));return this.updateRequestToBeCancellable(o,t),o},r.prototype.put=function(n,e,a){var i=a?.provider||ie,t=this._pluggables.find(function(c){return c.getProviderName()===i});if(t===void 0)return Z.debug("No plugin found with providerName",i),Promise.reject("No plugin found in Storage for the provider");var o=this.getAbortController(),u=t.put(n,e,B(B({},a),{abortSignal:o.signal}));return this.isUploadTask(u)||this.updateRequestToBeCancellable(u,o),u},r.prototype.remove=function(n,e){var a=e?.provider||ie,i=this._pluggables.find(function(t){return t.getProviderName()===a});return i===void 0?(Z.debug("No plugin found with providerName",a),Promise.reject("No plugin found in Storage for the provider")):i.remove(n,e)},r.prototype.list=function(n,e){var a=e?.provider||ie,i=this._pluggables.find(function(t){return t.getProviderName()===a});return i===void 0?(Z.debug("No plugin found with providerName",a),Promise.reject("No plugin found in Storage for the provider")):i.list(n,e)},r}(),ae=null,Ys=function(){if(ae)return ae;st.debug("Create Storage Instance, debug"),ae=new Zt,ae.vault=new Zt;var r=ae.configure;return ae.configure=function(n){st.debug("storage configure called");var e=B({},r.call(ae,n));Object.keys(e).forEach(function(a){typeof e[a]!="string"&&(e[a]=B(B({},e[a]),{level:"private"}))}),st.debug("storage vault configure called"),ae.vault.configure(e)},ae},Zs=Ys();yn.register(Zs);export{Zs as S};
